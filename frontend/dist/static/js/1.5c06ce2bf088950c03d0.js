webpackJsonp([1],{BO1k:function(t,e,r){t.exports={default:r("fxRn"),__esModule:!0}},fxRn:function(t,e,r){r("+tPU"),r("zQR9"),t.exports=r("g8Ux")},g8Ux:function(t,e,r){var s=r("77Pl"),a=r("3fs2");t.exports=r("FeBl").getIterator=function(t){var e=a(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return s(e.call(t))}},"l+6m":function(t,e){},mvHQ:function(t,e,r){t.exports={default:r("qkKv"),__esModule:!0}},qkKv:function(t,e,r){var s=r("FeBl"),a=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},rtsM:function(t,e,r){var s;!function(){"use strict";for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",a=new Uint8Array(256),i=0;i<r.length;i++)a[r.charCodeAt(i)]=i;var n=function(t){var e,s=new Uint8Array(t),a=s.length,i="";for(e=0;e<a;e+=3)i+=r[s[e]>>2],i+=r[(3&s[e])<<4|s[e+1]>>4],i+=r[(15&s[e+1])<<2|s[e+2]>>6],i+=r[63&s[e+2]];return a%3==2?i=i.substring(0,i.length-1):a%3==1&&(i=i.substring(0,i.length-2)),i},o=function(t){var e,r,s,i,n,o=.75*t.length,c=t.length,u=0,d=new ArrayBuffer(o),l=new Uint8Array(d);for(e=0;e<c;e+=4)r=a[t.charCodeAt(e)],s=a[t.charCodeAt(e+1)],i=a[t.charCodeAt(e+2)],n=a[t.charCodeAt(e+3)],l[u++]=r<<2|s>>4,l[u++]=(15&s)<<4|i>>2,l[u++]=(3&i)<<6|63&n;return d};void 0!==t&&void 0!==t.exports?t.exports={encode:n,decode:o}:void 0===(s=function(){return{encode:n,decode:o}}.apply(e,[]))||(t.exports=s)}()},xJsL:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r("//Fk"),a=r.n(s),i=r("BO1k"),n=r.n(i),o=r("Xxa5"),c=r.n(o),u=r("exGp"),d=r.n(u),l=r("mvHQ"),v=r.n(l),p=r("rtsM"),h=r("Tk3H"),f=r("Okpk"),m=r("+cKO"),y={name:"Login",components:{ThemeButton:f.a},data:function(){return{baseurl:"",switch1:!0,otpScreen:!1,otpError:!1,loginId:0,signUpOption:!1,versionOption:"v1.0.0",activeUser:{user:null,token:""},user:{email:"",password:""},otpForm:{otp:""},submitted:!1,submitted2:!1,signupRoute:"",keyScreen:!1,keyTotpScreen:!1,keys:[],mfa:!1,harwarekey:!1,activeKey:!1,verification_method:!1,crid:null}},validations:{user:{email:{required:m.required,minLength:Object(m.minLength)(2)},password:{required:m.required,minLength:Object(m.minLength)(6)}}},mounted:function(){this.signupRoute="/"+this.$route.params.appdirectory+"/signup",this.fnLogin(),this.getsignup(),this.getVersion()},methods:{fnLogin:function(){var t=this,e={url:"auth/check-directoryname",data:{dirname:this.$route.params.appdirectory}};this.$store.dispatch(h.c,e).then(function(e){t.$cookie.get("access_token")?"nodir"===e.data.status||"no-name"===e.data.status?t.$router.push("/"+e.data.dir+"/dashboard"):"false"===e.data.status?t.$router.push("/404"):"true"===e.data.status&&t.$router.push("/"+e.data.dir+"/dashboard"):"nodir"===e.data.status&&"voip"===e.data.dir?t.$router.push("/"+e.data.dir):"no-name"===e.data.status&&"voip"===e.data.dir?t.$router.push("/"+e.data.dir):"false"!==e.data.status&&"no-name"!==e.data.status||t.$router.push("/404")}).catch(function(e){t.old_version=!1,console.log(e)})},getsignup:function(){var t=this;this.$store.dispatch(h.c,{data:{},url:"auth/get-signup"}).then(function(e){e&&"on"===e.data?t.signUpOption=!0:t.signUpOption=!1}).catch(function(e){t.signUpOption=!1})},getVersion:function(){var t=this;this.$store.dispatch(h.c,{data:{},url:"auth/get-version"}).then(function(e){e&&(t.versionOption=e.data)}).catch(function(t){})},handleSubmit:function(t){var e=this;if(t.preventDefault(),this.submitted=!0,this.$v.$touch(),!this.$v.$invalid){var r={data:this.user,url:"auth/login"};this.$store.dispatch(h.c,r).then(function(t){t&&(e.keys=t.harwarekey,e.mfa=t.mfa,e.verification_method=!1,"hardwarekey"===t.status?(e.activeUser.token=t.token,e.activeUser.user=t.data,e.keyScreen=!0,e.otpScreen=!1,e.activeKey=t.harwarekey[0]):"mfa"===t.status?(e.activeUser.token=t.token,e.activeUser.user=t.data,e.otpScreen=!0):(e.$cookie.set("access_token",t.token,30),e.$cookie.set("userdata",v()(t.data),30),e.$router.push("/"+e.$route.params.appdirectory+"/dashboard")))}).catch(function(t){})}},verifyKey:function(t){var e,r=this,s={data:{user:this.activeUser.user._id,title:t.title},url:"hardwarekey/login-key"};this.$store.dispatch(h.c,s).then((e=d()(c.a.mark(function t(e){var s,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=17;break}return t.next=3,r.preformatGetAssertReq(e);case 3:return e=t.sent,t.prev=4,t.next=7,navigator.credentials.get({publicKey:e});case 7:s=t.sent,s=r.publicKeyCredentialToJSON(s),a={data:s,url:"hardwarekey/login"},r.$store.dispatch(h.c,a).then(function(){var t=d()(c.a.mark(function t(e){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=8;break}if("true"===e.status){t.next=3;break}throw new Error("Error registering user! Server returned: "+e.errorMessage);case 3:r.$cookie.set("access_token",r.activeUser.token,30),r.$cookie.set("userdata",v()(r.activeUser.user),30),r.activeUser.token="",r.activeUser.user=null,r.$router.push("/"+r.$route.params.appdirectory+"/dashboard");case 8:case"end":return t.stop()}},t,r)}));return function(e){return t.apply(this,arguments)}}()).catch(function(t){}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(4),console.log(t.t0),r.$swal.fire("Key!","Login failed with security key.","error");case 17:case"end":return t.stop()}},t,r,[[4,13]])})),function(t){return e.apply(this,arguments)})).catch(function(t){})},generateRandomBuffer:function(t){t||(t=32);var e=new Uint8Array(t);return window.crypto.getRandomValues(e),e},publicKeyCredentialToJSON:function(t){if(t instanceof Array){var e=[],r=!0,s=!1,a=void 0;try{for(var i,o=n()(t);!(r=(i=o.next()).done);r=!0){var c=i.value;e.push(this.publicKeyCredentialToJSON(c))}}catch(t){s=!0,a=t}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return e}if(t instanceof ArrayBuffer)return Object(p.encode)(t);if(t instanceof Object){var u={};for(var d in t)u[d]=this.publicKeyCredentialToJSON(t[d]);return u}return t},preformatGetAssertReq:function(t){return new a.a(function(e,r){if(t.challenge=Object(p.decode)(t.challenge),t.allowCredentials){var s=!0,a=!1,i=void 0;try{for(var o,c=n()(t.allowCredentials);!(s=(o=c.next()).done);s=!0){var u=o.value;console.log(u.id),u.id=Object(p.decode)(u.id)}}catch(t){a=!0,i=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw i}}}e(t)})},handleSubmit2:function(t){var e=this;if(this.submitted2=!0,""!==this.otpForm.otp.trim()){var r={data:{user:this.activeUser.user._id,verification_code:this.otpForm.otp},url:"auth/otp-verify"};this.$store.dispatch(h.c,r).then(function(t){t&&"true"===t.status&&(e.$cookie.set("access_token",e.activeUser.token,30),e.$cookie.set("userdata",v()(e.activeUser.user),30),e.activeUser.token="",e.activeUser.user=null,e.$router.push("/"+e.$route.params.appdirectory+"/dashboard"))}).catch(function(t){})}else this.otpError=!0},chooseMethods:function(t){"hardware_key"===t?(this.otpScreen=!1,this.keyScreen=!0,this.verification_method=!1):"show_method"===t?(this.otpScreen=!1,this.keyScreen=!0,this.verification_method=!0):"Cancel"===t?(this.otpScreen=!1,this.keyScreen=!1,this.activeUser={user:null,token:""},this.user={email:"",password:""}):"mfa"===t&&(this.keyScreen=!1,this.otpScreen=!0,this.verification_method=!1)}}},_={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"login-box dark-mode p-3"},[r("theme-button",{attrs:{"id-hide":"false"}}),t._v(" "),r("h1",{staticClass:"dark-mode"},[t._v("Login")]),t._v(" "),t.otpScreen||t.keyScreen?t._e():r("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[r("div",{staticClass:"form-group mt-4"},[r("b-input-group",[r("b-input-group-prepend",{attrs:{"is-text":""}},[r("b-icon",{attrs:{icon:"person-fill"}})],1),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control chat-input",class:{"is-invalid":t.submitted&&t.$v.user.email.$error},attrs:{type:"text",placeholder:"Username",title:"Enter Username"},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.email.$error?r("div",{staticClass:"invalid-feedback"},[t.$v.user.email.required?t._e():r("span",[t._v("Username is required")]),t._v(" "),t.$v.user.email.minLength?t._e():r("span",[t._v("Username is invalid")])]):t._e()],1),t._v(" "),r("div",{staticClass:"form-group mb-2 mt-4"},[r("b-input-group",[r("b-input-group-prepend",{attrs:{"is-text":""}},[r("b-icon",{attrs:{icon:"shield-lock"}})],1),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"chat-input form-control",class:{"is-invalid":t.submitted&&t.$v.user.password.$error},attrs:{type:"password",placeholder:"Password",title:"Enter Password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.password.$error?r("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():r("span",[t._v("Password is required")]),t._v(" "),t.$v.user.password.minLength?t._e():r("span",[t._v("Password is invalid")])]):t._e()],1),t._v(" "),t._m(0),t._v(" "),t.signUpOption?r("div",{staticClass:"my-2 small"},[t._v("\n            Donâ€™t have an account yet? "),r("router-link",{staticClass:"mx-2",attrs:{to:t.signupRoute}},[t._v(" Sign up")])],1):r("div",{staticClass:"d-grid d-md-flex mt-2 small"},[t._v("\n            New registrations are disabled\n          ")])]),t._v(" "),r("form",{staticClass:"ml-2 mr-2 text-center",class:{"d-none":!t.otpScreen}},[r("div",{staticClass:"form-group my-4"},[r("label",[t._v("Enter Verification Code")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.otpForm.otp,expression:"otpForm.otp"}],staticClass:"totp",class:{"is-invalid":t.submitted2&&t.otpError},attrs:{type:"form-control",maxlength:"6",placeholder:"000000"},domProps:{value:t.otpForm.otp},on:{input:function(e){e.target.composing||t.$set(t.otpForm,"otp",e.target.value)}}}),t._v(" "),t.submitted2&&t.otpError?r("div",{staticClass:"invalid-feedback"},[r("span",[t._v("Verification code is required")])]):t._e()]),t._v(" "),r("div",{staticClass:"text-center"},[r("button",{staticClass:"btn btn-success m-3 px-5",attrs:{type:"button",id:"login-button2"},on:{click:function(e){return t.handleSubmit2(e)}}},[t._v("Verify")])]),t._v(" "),r("div",{staticClass:"p-2"},[r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.chooseMethods("show_method")}}},[t._v("Choose A Different Verification Method")])])]),t._v(" "),t.keyScreen?r("form",{staticClass:"ml-2 mr-2 text-center"},[t.verification_method?r("div",{},[t.keys.length>0?r("div",{staticClass:"card my-4"},[r("div",{staticClass:"card-body",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.chooseMethods("hardware_key")}}},[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("div",{staticClass:"px-4"},[r("b-icon",{attrs:{icon:"key"}})],1),t._v(" "),t._m(1)])])]):t._e(),t._v(" "),t.mfa?r("div",{staticClass:"card"},[r("div",{staticClass:"card-body",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.chooseMethods("mfa")}}},[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("div",{staticClass:"px-4"},[r("b-icon",{attrs:{icon:"calculator-fill"}})],1),t._v(" "),t._m(2)])])]):t._e(),t._v(" "),r("div",{staticClass:"p-2"},[r("a",{staticClass:"mt-2",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.chooseMethods("Cancel")}}},[t._v("Cancel")])])]):r("div",[t._l(t.keys,function(e){return r("div",{key:e._id,staticClass:"card my-4"},[r("div",{staticClass:"card-body"},[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("div",[r("b-icon",{attrs:{icon:"key"}}),r("span",{staticClass:"mr-2"},[t._v(" "+t._s(e.title)+" ")])],1),t._v(" "),r("div",[r("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(r){return t.verifyKey(e)}}},[t._v("Verify")])])])])])}),t._v(" "),r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.chooseMethods("show_method")}}},[t._v("Choose A Different Verification Method")])],2)]):t._e(),t._v(" "),r("div",{staticClass:"d-flex my-4 justify-content-center"},[r("a",{attrs:{href:"https://www.twitter.com/0perationP",target:"_blank",rel:"noopener noreferrer","aria-label":"Twitter",title:"Twitter"}},[r("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"twitter",variant:"secondary"}})],1),t._v(" "),r("a",{attrs:{href:"https://github.com/0perationPrivacy/",target:"_blank",rel:"noopener noreferrer","aria-label":"Github",title:"Github"}},[r("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"github",variant:"secondary"}})],1),t._v(" "),r("a",{attrs:{href:"https://www.OperationPrivacy.com/donate",target:"_blank",rel:"noopener noreferrer","aria-label":"Donate",title:"Donate"}},[r("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"credit-card",variant:"secondary"}})],1)])],1),t._v(" "),r("p",{staticClass:"version"},[t._v(t._s(t.versionOption))])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-grid"},[e("button",{staticClass:"btn btn-success mt-3",attrs:{type:"submit",id:"login-button"}},[this._v("Login")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"border-dark px-2",staticStyle:{"border-left":"1px solid"}},[e("h4",[this._v("Security Key")]),this._v(" "),e("p",[this._v("Use a hardwaree security key that is paired with your account. ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"border-dark px-2",staticStyle:{"border-left":"1px solid"}},[e("h4",[this._v("TOTP Code")]),this._v(" "),e("p",[this._v("Use a time based on-time verification passcode. ")])])}]};var b=r("VU/8")(y,_,!1,function(t){r("l+6m")},"data-v-116659b0",null);e.default=b.exports}});
//# sourceMappingURL=1.5c06ce2bf088950c03d0.js.map