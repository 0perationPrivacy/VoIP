webpackJsonp([1],{"/hSy":function(t,e){},"0Owv":function(t,e,i){"use strict";(function(t,s){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function n(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]])}return i}function a(t,e,i,s){return new(i||(i=Promise))(function(n,a){function o(t){try{l(s.next(t))}catch(t){a(t)}}function r(t){try{l(s.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(o,r)}l((s=s.apply(t,e||[])).next())})}i.d(e,"a",function(){return Wt});var o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16);function l(){if(!o)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(r)}for(var c=[],d=0;d<256;++d)c[d]=(d+256).toString(16).substr(1);function u(t,e,i){var s=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var n=(t=t||{}).random||(t.rng||l)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e)for(var a=0;a<16;++a)e[s+a]=n[a];return e||function(t,e){var i=0,s=c;return[s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]]].join("")}(n)}var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},m=function(t,e){return function(t){var e,i;e=h,i=function(){var t=function(){},e="undefined",i=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),s=["trace","debug","info","warn","error"];function n(t,e){var i=t[e];if("function"==typeof i.bind)return i.bind(t);try{return Function.prototype.bind.call(i,t)}catch(e){return function(){return Function.prototype.apply.apply(i,[t,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(s){return"debug"===s&&(s="log"),typeof console!==e&&("trace"===s&&i?a:void 0!==console[s]?n(console,s):void 0!==console.log?n(console,"log"):t)}function r(e,i){for(var n=0;n<s.length;n++){var a=s[n];this[a]=n<e?t:this.methodFactory(a,e,i)}this.log=this.debug}function l(t,i,s){return function(){typeof console!==e&&(r.call(this,i,s),this[t].apply(this,arguments))}}function c(t,e,i){return o(t)||l.apply(this,arguments)}function d(t,i,n){var a,o=this,l="loglevel";function d(){var t;if(typeof window!==e&&l){try{t=window.localStorage[l]}catch(t){}if(typeof t===e)try{var i=window.document.cookie,s=i.indexOf(encodeURIComponent(l)+"=");-1!==s&&(t=/^([^;]+)/.exec(i.slice(s))[1])}catch(t){}return void 0===o.levels[t]&&(t=void 0),t}}"string"==typeof t?l+=":"+t:"symbol"==typeof t&&(l=void 0),o.name=t,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=n||c,o.getLevel=function(){return a},o.setLevel=function(i,n){if("string"==typeof i&&void 0!==o.levels[i.toUpperCase()]&&(i=o.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(a=i,!1!==n&&function(t){var i=(s[t]||"silent").toUpperCase();if(typeof window!==e&&l){try{return void(window.localStorage[l]=i)}catch(t){}try{window.document.cookie=encodeURIComponent(l)+"="+i+";"}catch(t){}}}(i),r.call(o,i,t),typeof console===e&&i<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(t){d()||o.setLevel(t,!1)},o.enableAll=function(t){o.setLevel(o.levels.TRACE,t)},o.disableAll=function(t){o.setLevel(o.levels.SILENT,t)};var u=d();null==u&&(u=null==i?"WARN":i),o.setLevel(u,!1)}var u=new d,h={};u.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=h[t];return e||(e=h[t]=new d(t,u.getLevel(),u.methodFactory)),e};var m=typeof window!==e?window.log:void 0;return u.noConflict=function(){return typeof window!==e&&window.log===u&&(window.log=m),u},u.getLoggers=function(){return h},u.default=u,u},t.exports?t.exports=i():e.log=i()}(e={exports:{}}),e.exports}();const p=m.getLogger("telnyx"),v=p.methodFactory;p.methodFactory=((t,e,i)=>{const s=v(t,e,i);return function(){const t=[(()=>(new Date).toISOString().replace("T"," ").replace("Z",""))(),"-"];for(let e=0;e<arguments.length;e++)t.push(arguments[e]);s.apply(void 0,t)}}),p.setLevel(p.getLevel());const f={urls:"stun:stun.telnyx.com:3478"},g={urls:"turn:turn.telnyx.com:3478?transport=tcp",username:"testuser",credential:"testpassword"};var _;!function(t){t.SocketOpen="telnyx.socket.open",t.SocketClose="telnyx.socket.close",t.SocketError="telnyx.socket.error",t.SocketMessage="telnyx.socket.message",t.SpeedTest="telnyx.internal.speedtest",t.Ready="telnyx.ready",t.Error="telnyx.error",t.Notification="telnyx.notification",t.Messages="telnyx.messages",t.Calls="telnyx.calls",t.MediaError="telnyx.rtc.mediaError"}(_||(_={}));const b=t=>0===Object.keys(t).length,w=t=>"@telnyx:"+t,C=t=>{const[e,i,s,n,a,o]=t;let r={};try{r=JSON.parse(a.replace(/ID"/g,'Id"'))}catch(t){p.warn("Verto LA invalid media JSON string:",a)}return{participantId:Number(e),participantNumber:i,participantName:s,codec:n,media:r,participantData:o}},y=t=>{if("string"!=typeof t)return t;try{return JSON.parse(t)}catch(e){return t}},S=t=>t instanceof Function||"function"==typeof t,k=t=>"object"==typeof document&&"getElementById"in document?"string"==typeof t?document.getElementById(t)||null:"function"==typeof t?t():t instanceof HTMLMediaElement?t:null:null,x=/^(ws|wss):\/\//,$=(t,e=null)=>{const{result:i={},error:s}=t;if(s)return{error:s};const{result:n=null}=i;if(null===n)return null!==e&&(i.node_id=e),{result:i};const{code:a=null,node_id:o=null,result:r=null}=n;return a&&"200"!==a?{error:n}:r?$(r,o):{result:n}},I=({login:t,passwd:e,password:i,login_token:s})=>Boolean(t&&(e||i)||s),N={},E=(t,e)=>`${t}|${e}`,P=(t,e="GLOBAL")=>E(t,e)in N,A=(t,e,i="GLOBAL")=>{const s=E(t,i);s in N||(N[s]=[]),N[s].push(e)},T=(t,e,i="GLOBAL")=>{const s=function(n){L(t,s,i),e(n)};return s.prototype.targetRef=e,A(t,s,i)},L=(t,e,i="GLOBAL")=>{if(!P(t,i))return!1;const s=E(t,i);if(S(e))for(let t=N[s].length-1;t>=0;t--){const i=N[s][t];(e===i||i.prototype&&e===i.prototype.targetRef)&&N[s].splice(t,1)}else N[s]=[];return 0===N[s].length&&delete N[s],!0},D=(t,e,i="GLOBAL",s=!0)=>{const n=s&&"GLOBAL"!==i;if(!P(t,i))return n&&D(t,e),!1;const a=E(t,i),o=N[a].length;if(!o)return n&&D(t,e),!1;for(let t=o-1;t>=0;t--)N[a][t](e);return n&&D(t,e),!0},O=t=>{const e=E(t,"");Object.keys(N).filter(t=>0===t.indexOf(e)).forEach(t=>delete N[t])};let R="undefined"!=typeof WebSocket?WebSocket:null;const M=0,q=1,U=2,F=3;class B{constructor(t){this.session=t,this._wsClient=null,this._host="wss://rtc.telnyx.com:14938",this._timers={},this.upDur=null,this.downDur=null;const{host:e,env:i}=t.options;e&&(this._host=(t=>`${x.test(t)?"":"wss://"}${t}`)(e)),i&&(this._host="development"===i?"wss://rtcdev.telnyx.com:14938":"wss://rtc.telnyx.com:14938")}get connected(){return this._wsClient&&this._wsClient.readyState===q}get connecting(){return this._wsClient&&this._wsClient.readyState===M}get closing(){return this._wsClient&&this._wsClient.readyState===U}get closed(){return this._wsClient&&this._wsClient.readyState===F}get isAlive(){return this.connecting||this.connected}get isDead(){return this.closing||this.closed}connect(){this._wsClient=new R(this._host),this._wsClient.onopen=(t=>D(_.SocketOpen,t,this.session.uuid)),this._wsClient.onclose=(t=>D(_.SocketClose,t,this.session.uuid)),this._wsClient.onerror=(t=>D(_.SocketError,t,this.session.uuid)),this._wsClient.onmessage=(t=>{const e=y(t.data);"string"!=typeof e?(this._unsetTimer(e.id),p.debug("RECV: \n",JSON.stringify(e,null,2),"\n"),D(e.id,e)||D(_.SocketMessage,e,this.session.uuid)):this._handleStringResponse(e)})}sendRawText(t){this._wsClient.send(t)}send(t){const{request:e}=t,i=new Promise((t,i)=>{if(e.hasOwnProperty("result"))return t();T(e.id,e=>{const{result:s,error:n}=$(e);return n?i(n):t(s)}),this._setTimer(e.id)});return p.debug("SEND: \n",JSON.stringify(e,null,2),"\n"),this._wsClient.send(JSON.stringify(e)),i}close(){this._wsClient&&(S(this._wsClient._beginClose)?this._wsClient._beginClose():this._wsClient.close()),this._wsClient=null}_unsetTimer(t){clearTimeout(this._timers[t]),delete this._timers[t]}_setTimer(t){this._timers[t]=setTimeout(()=>{D(t,{error:{code:this.session.timeoutErrorCode,message:"Timeout"}}),this._unsetTimer(t)},1e4)}_handleStringResponse(t){if(/^#SP/.test(t))switch(t[3]){case"U":this.upDur=parseInt(t.substring(4));break;case"D":this.downDur=parseInt(t.substring(4)),D(_.SpeedTest,{upDur:this.upDur,downDur:this.downDur},this.session.uuid)}else p.warn("Unknown message from socket",t)}}const V=()=>"undefined"==typeof window&&void 0!==s,j=t=>((t,e)=>a(void 0,void 0,void 0,function*(){if(V())return null;const t=window.sessionStorage.getItem(w(e));return y(t)}))(0,t),z=(t,e)=>((t,e,i)=>a(void 0,void 0,void 0,function*(){if(V())return null;"object"==typeof i&&(i=JSON.stringify(i)),window.sessionStorage.setItem(w(e),i)}))(0,t,e),H=t=>((t,e)=>a(void 0,void 0,void 0,function*(){return V()?null:window.sessionStorage.removeItem(w(e))}))(0,t);var J,G,W;!function(t){t.Offer="offer",t.Answer="answer"}(J||(J={})),function(t){t.Inbound="inbound",t.Outbound="outbound"}(G||(G={})),function(t){t.Invite="telnyx_rtc.invite",t.Attach="telnyx_rtc.attach",t.Answer="telnyx_rtc.answer",t.Info="telnyx_rtc.info",t.Display="telnyx_rtc.display",t.Media="telnyx_rtc.media",t.Event="telnyx_rtc.event",t.Bye="telnyx_rtc.bye",t.Punt="telnyx_rtc.punt",t.Broadcast="telnyx_rtc.broadcast",t.Subscribe="telnyx_rtc.subscribe",t.Unsubscribe="telnyx_rtc.unsubscribe",t.ClientReady="telnyx_rtc.clientReady",t.Modify="telnyx_rtc.modify",t.Ringing="telnyx_rtc.ringing",t.GatewayState="telnyx_rtc.gatewayState"}(W||(W={}));const K={generic:"event",[W.Display]:"participantData",[W.Attach]:"participantData",conferenceUpdate:"conferenceUpdate",callUpdate:"callUpdate",vertoClientReady:"vertoClientReady",userMediaError:"userMediaError"},Z={destinationNumber:"",remoteCallerName:"Outbound Call",remoteCallerNumber:"",callerName:"",callerNumber:"",audio:!0,video:!1,useStereo:!1,attach:!1,screenShare:!1,userVariables:{},mediaSettings:{useSdpASBandwidthKbps:!1,sdpASBandwidthKbps:0}};var Y,X,Q,tt;!function(t){t[t.New=0]="New",t[t.Requesting=1]="Requesting",t[t.Trying=2]="Trying",t[t.Recovering=3]="Recovering",t[t.Ringing=4]="Ringing",t[t.Answering=5]="Answering",t[t.Early=6]="Early",t[t.Active=7]="Active",t[t.Held=8]="Held",t[t.Hangup=9]="Hangup",t[t.Destroy=10]="Destroy",t[t.Purge=11]="Purge"}(Y||(Y={})),function(t){t.Participant="participant",t.Moderator="moderator"}(X||(X={})),function(t){t.Join="join",t.Leave="leave",t.Bootstrap="bootstrap",t.Add="add",t.Modify="modify",t.Delete="delete",t.Clear="clear",t.ChatMessage="chatMessage",t.LayerInfo="layerInfo",t.LogoInfo="logoInfo",t.LayoutInfo="layoutInfo",t.LayoutList="layoutList",t.ModCmdResponse="modCommandResponse"}(Q||(Q={})),function(t){t.Video="videoinput",t.AudioIn="audioinput",t.AudioOut="audiooutput"}(tt||(tt={}));const et=t=>navigator.mediaDevices.getUserMedia(t),it=t=>t&&t instanceof MediaStream,st=(t,e)=>{const i=k(t);null!==i&&(i.getAttribute("autoplay")||i.setAttribute("autoplay","autoplay"),i.getAttribute("playsinline")||i.setAttribute("playsinline","playsinline"),i.srcObject=e)},nt=(t,e)=>a(void 0,void 0,void 0,function*(){const i=k(t);if(null===i)return p.info("No HTMLMediaElement to attach the speakerId"),!1;if("string"!=typeof e)return p.info(`Invalid speaker deviceId: '${e}'`),!1;try{return yield i.setSinkId(e),!0}catch(t){return!1}}),at=t=>{t&&"live"===t.readyState&&t.stop()},ot=t=>{it(t)&&t.getTracks().forEach(at),t=null},rt=t=>a(void 0,void 0,void 0,function*(){p.info("RTCService.getUserMedia",t);const{audio:e,video:i}=t;if(!e&&!i)return null;try{return yield et(t)}catch(t){throw p.error("getUserMedia error: ",t),t}}),lt=(t=null,e=!1)=>a(void 0,void 0,void 0,function*(){let i=yield navigator.mediaDevices.enumerateDevices().catch(t=>(console.error("enumerateDevices",t),[]));if(t&&(i=i.filter(e=>e.kind===t)),!i.length||!i.every(t=>t.deviceId&&t.label)){const e=yield et(((t=null)=>({audio:!t||t===tt.AudioIn||t===tt.AudioOut,video:!t||t===tt.Video}))(t));return ot(e),lt(t)}if(!0===e)return i;const s=[];return i=i.filter(({kind:t,groupId:e})=>{if(!e)return!0;const i=`${t}-${e}`;return!s.includes(i)&&(s.push(i),!0)})}),ct=[[320,240],[640,360],[640,480],[1280,720],[1920,1080]],dt=(t,e,i)=>a(void 0,void 0,void 0,function*(){const s=yield lt(i,!0);for(let i=0;i<s.length;i++){const{deviceId:n,label:a}=s[i];if(t===n||e===a)return n}return null}),ut=t=>{const e=navigator.mediaDevices.getSupportedConstraints();Object.keys(t).map(i=>{e.hasOwnProperty(i)&&null!==t[i]&&void 0!==t[i]||delete t[i]})},ht=(t,e,i,s)=>a(void 0,void 0,void 0,function*(){const{deviceId:n}=s;if(void 0===n&&(t||e)){const n=yield dt(t,e,i).catch(t=>null);n&&(s.deviceId={exact:n})}return s}),mt=t=>{const e="\r\n",i=t.split(e),s=i.findIndex(t=>/^a=rtpmap/.test(t)&&/opus\/48000/.test(t));if(s<0)return t;const n=(t=>{const e=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),i=t.match(e);return i&&2==i.length?i[1]:null})(i[s]),a=new RegExp("a=fmtp:"+n),o=i.findIndex(t=>a.test(t));return o>=0?/stereo=1;/.test(i[o])||(i[o]+="; stereo=1; sprop-stereo=1"):i[s]+=`\r\na=fmtp:${n} stereo=1; sprop-stereo=1`,i.join(e)},pt=t=>/^m=audio/.test(t),vt=t=>/^m=video/.test(t),ft=(t,e)=>{const i="\r\n",s=e.split(i);if(s.findIndex(pt)<s.findIndex(vt))return t;const n=t.split(i),a=n.findIndex(pt),o=n.findIndex(vt),r=n.slice(a,o),l=n.slice(o,n.length-1);return[...n.slice(0,a),...l,...r,""].join(i)},gt=(t,e)=>{if(!t)return!1;const{subscribed:i,alreadySubscribed:s}=_t(t);return i.includes(e)||s.includes(e)},_t=t=>{const e={subscribed:[],alreadySubscribed:[],unauthorized:[],unsubscribed:[],notSubscribed:[]};return Object.keys(e).forEach(i=>{e[i]=t[i+"Channels"]||[]}),e},bt=(t,e=null,i=null)=>{if(!it(t))return null;let s=[];switch(e){case"audio":s=t.getAudioTracks();break;case"video":s=t.getVideoTracks();break;default:s=t.getTracks()}s.forEach(t=>{switch(i){case"on":case!0:t.enabled=!0;break;case"off":case!1:t.enabled=!1;break;default:t.enabled=!t.enabled}})},wt=t=>{bt(t,"audio",!0)},Ct=t=>{bt(t,"audio",!1)},yt=t=>{bt(t,"audio",null)};var St;function kt(t,e){const i=document.getElementById(e);if(i)return i;if(t&&e){const i=document.createElement("audio");return i.id=e,i.loop=!0,i.src=t,i.preload="auto",i.load(),document.body.appendChild(i),i}return null}function xt(t){t&&(t._playFulfilled=!1,t._promise=t.play(),t._promise.then(()=>{t._playFulfilled=!0}).catch(e=>{console.error("playAudio",e),t._playFulfilled=!0}))}function $t(t){t&&(t._playFulfilled?(t.pause(),t.currentTime=0):t._promise&&t._promise.then?t._promise.then(()=>{t.pause(),t.currentTime=0}):setTimeout(()=>{t.pause(),t.currentTime=0},1e3))}!function(t){t.not_supported="not supported",t.full="full",t.partial="partial"}(St||(St={}));const It={id:"callID",destinationNumber:"destination_number",remoteCallerName:"remote_caller_id_name",remoteCallerNumber:"remote_caller_id_number",callerName:"caller_id_name",callerNumber:"caller_id_number"};class Nt extends class{buildRequest(t){this.request=Object.assign({jsonrpc:"2.0",id:u()},t)}}{constructor(t={}){if(super(),t.hasOwnProperty("dialogParams")){const e=n(t.dialogParams,["remoteSdp","localStream","remoteStream","onNotification","camId","micId","speakerId"]);for(const t in It)t&&e.hasOwnProperty(t)&&(e[It[t]]=e[t],delete e[t]);t.dialogParams=e}this.buildRequest({method:this.toString(),params:t})}}class Et extends Nt{constructor(t,e,i,s,n={}){super(),this.method="login";const a={login:t,passwd:e,login_token:i,userVariables:n,loginParams:{}};s&&(a.sessid=s),this.buildRequest({method:this.method,params:a})}}class Pt extends Nt{constructor(t,e){super(),this.buildRequest({id:t,result:{method:e}})}}class At extends Nt{toString(){return W.Invite}}class Tt extends Nt{toString(){return W.Answer}}class Lt extends Nt{toString(){return W.Attach}}class Dt extends Nt{toString(){return W.Bye}}class Ot extends Nt{toString(){return W.Modify}}class Rt extends Nt{toString(){return W.Info}}class Mt extends Nt{toString(){return W.Broadcast}}class qt extends Nt{toString(){return W.Subscribe}}class Ut extends Nt{toString(){return W.Unsubscribe}}class Ft{constructor(t,e){this.type=t,this.options=e,this.onSdpReadyTwice=null,this._negotiating=!1,p.info("New Peer with type:",this.type,"Options:",this.options),this._constraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this._sdpReady=this._sdpReady.bind(this),this.handleSignalingStateChangeEvent=this.handleSignalingStateChangeEvent.bind(this),this.handleNegotiationNeededEvent=this.handleNegotiationNeededEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.createPeerConnection=this.createPeerConnection.bind(this),this._init()}get isOffer(){return this.type===J.Offer}get isAnswer(){return this.type===J.Answer}startNegotiation(){this._negotiating=!0,this._isOffer()?this._createOffer():this._createAnswer()}_logTransceivers(){p.info("Number of transceivers:",this.instance.getTransceivers().length),this.instance.getTransceivers().forEach((t,e)=>{p.info(`>> Transceiver [${e}]:`,t.mid,t.direction,t.stopped),p.info(`>> Sender Params [${e}]:`,JSON.stringify(t.sender.getParameters(),null,2))})}handleSignalingStateChangeEvent(t){switch(p.info("signalingState:",this.instance.signalingState),this.instance.signalingState){case"stable":this._negotiating=!1;break;case"closed":this.instance=null;break;default:this._negotiating=!0}}handleNegotiationNeededEvent(){p.info("Negotiation needed event"),"stable"===this.instance.signalingState&&this.startNegotiation()}handleTrackEvent(t){const{streams:[e]}=t,{remoteElement:i,screenShare:s}=this.options;let{remoteStream:n}=this.options;!1===s&&st(i,n=e)}createPeerConnection(){return a(this,void 0,void 0,function*(){var t;this.instance=(t=this._config(),new window.RTCPeerConnection(t)),this.instance.onsignalingstatechange=this.handleSignalingStateChangeEvent,this.instance.onnegotiationneeded=this.handleNegotiationNeededEvent,this.instance.ontrack=this.handleTrackEvent,this.instance.addEventListener("addstream",t=>{this.options.remoteStream=t.stream}),this.options.localStream=yield this._retrieveLocalStream().catch(t=>(D(_.MediaError,t,this.options.id),null))})}_init(){return a(this,void 0,void 0,function*(){yield this.createPeerConnection();const{localElement:t,localStream:e=null,screenShare:i=!1}=this.options;if(it(e)){const s=e.getAudioTracks();p.info("Local audio tracks: ",s);const n=e.getVideoTracks();if(p.info("Local video tracks: ",n),this.isOffer&&"function"==typeof this.instance.addTransceiver){s.forEach(t=>{this.options.userVariables.microphoneLabel=t.label,this.instance.addTransceiver(t,{direction:"sendrecv",streams:[e]})});const t={direction:"sendrecv",streams:[e]};console.debug("Applying video transceiverParams",t),n.forEach(e=>{this.options.userVariables.cameraLabel=e.label,this.instance.addTransceiver(e,t)})}else"function"==typeof this.instance.addTrack?(s.forEach(t=>{this.options.userVariables.microphoneLabel=t.label,this.instance.addTrack(t,e)}),n.forEach(t=>{this.options.userVariables.cameraLabel=t.label,this.instance.addTrack(t,e)})):this.instance.addStream(e);!1===i&&((t=>{const e=k(t);e&&(e.muted=!0)})(t),st(t,e))}this.isOffer?(this.options.negotiateAudio&&this._checkMediaToNegotiate("audio"),this.options.negotiateVideo&&this._checkMediaToNegotiate("video")):this.startNegotiation(),this._logTransceivers()})}_getSenderByKind(t){return this.instance.getSenders().find(({track:e})=>e&&e.kind===t)}_checkMediaToNegotiate(t){if(!this._getSenderByKind(t)){const e=this.instance.addTransceiver(t);p.info("Add transceiver",t,e)}}_createOffer(){this._isOffer()&&(this._constraints.offerToReceiveAudio=Boolean(this.options.audio),this._constraints.offerToReceiveVideo=Boolean(this.options.video),p.info("_createOffer - this._constraints",this._constraints),this.instance.createOffer(this._constraints).then(this._setLocalDescription.bind(this)).then(this._sdpReady).catch(t=>p.error("Peer _createOffer error:",t)))}_setRemoteDescription(t){this.options.useStereo&&(t.sdp=mt(t.sdp)),this.instance.localDescription&&(t.sdp=ft(t.sdp,this.instance.localDescription.sdp));const e=t;return p.info("REMOTE SDP \n","Type: "+t.type,"\n\n",t.sdp),this.instance.setRemoteDescription(e)}_createAnswer(){return a(this,void 0,void 0,function*(){if(!this._isAnswer())return;if("stable"!==this.instance.signalingState)return console.log("  - But the signaling state isn't stable, so triggering rollback"),void(yield Promise.all([this.instance.setLocalDescription({type:"rollback"}),this.instance.setRemoteDescription({sdp:this.options.remoteSdp,type:J.Offer})]));yield this._setRemoteDescription({sdp:this.options.remoteSdp,type:J.Offer}),this._logTransceivers();const t=yield this.instance.createAnswer();yield this._setLocalDescription(t)})}_setLocalDescription(t){const{useStereo:e,googleMaxBitrate:i,googleMinBitrate:s,googleStartBitrate:n,mediaSettings:a}=this.options;return e&&(t.sdp=mt(t.sdp)),i&&s&&n&&(t.sdp=((t,e,i,s)=>{const n=t.split("\r\n");return n.forEach((t,a)=>{/^a=fmtp:\d*/.test(t)?n[a]+=`;x-google-max-bitrate=${e};x-google-min-bitrate=${i};x-google-start-bitrate=${s}`:/^a=mid:(1|video)/.test(t)&&(n[a]+="\r\nb=AS:"+e)}),n.join("\r\n")})(t.sdp,i,s,n)),a&&a.useSdpASBandwidthKbps&&null!==a.sdpASBandwidthKbps&&(t.sdp=((t,e)=>{let i="AS",s=e;return!navigator.userAgent.match(/firefox/gim)||navigator.userAgent.match(/OPR\/[0-9]{2}/gi)||navigator.userAgent.match(/edg/gim)||(i="TIAS",s=1e3*(e>>>0)),-1===t.indexOf("b="+i+":")?t.replace(/c=IN (.*)\r\n/,"c=IN $1\r\nb="+i+":"+s+"\r\n"):t.replace(new RegExp("b="+i+":.*\r\n"),"b="+i+":"+s+"\r\n")})(t.sdp,a.sdpASBandwidthKbps)),this.instance.setLocalDescription(t)}_sdpReady(){S(this.onSdpReadyTwice)&&this.onSdpReadyTwice(this.instance.localDescription)}_retrieveLocalStream(){return a(this,void 0,void 0,function*(){if(it(this.options.localStream))return this.options.localStream;const t=yield(e=this.options,a(void 0,void 0,void 0,function*(){let{audio:t=!0,micId:i}=e;const{micLabel:s=""}=e;i&&((i=yield dt(i,s,tt.AudioIn).catch(t=>null))&&("boolean"==typeof t&&(t={}),t.deviceId={exact:i}));let{video:n=!1,camId:a}=e;const{camLabel:o=""}=e;return a&&((a=yield dt(a,o,tt.Video).catch(t=>null))&&("boolean"==typeof n&&(n={}),n.deviceId={exact:a})),{audio:t,video:n}}));var e;return rt(t)})}_isOffer(){return this.type===J.Offer}_isAnswer(){return this.type===J.Answer}_config(){const{iceServers:t=[]}=this.options,e={bundlePolicy:"max-compat",iceServers:t};return p.info("RTC config",e),e}}const Bt=(t,e)=>{const{contentType:i,canvasType:s,callID:n,canvasInfo:a=null,currentLayerIdx:o=-1}=e;a&&"mcu-personal-canvas"!==s&&delete a.memberID;const r={type:K.conferenceUpdate,call:t.calls[n],canvasInfo:Vt(a),currentLayerIdx:o};switch(i){case"layer-info":{const e=Object.assign({action:Q.LayerInfo},r);D(_.Notification,e,t.uuid);break}case"layout-info":{const e=Object.assign({action:Q.LayoutInfo},r);D(_.Notification,e,t.uuid);break}}},Vt=t=>{const e=JSON.stringify(t).replace(/memberID/g,"participantId").replace(/ID"/g,'Id"').replace(/POS"/g,'Pos"');return y(e)},jt="2.5.6";class zt{constructor(t,e){this.session=t,this.id="",this.state=Y[Y.New],this.prevState="",this.channels=[],this.role=X.Participant,this.extension=null,this._state=Y.New,this._prevState=Y.New,this.gotAnswer=!1,this.gotEarly=!1,this._lastSerno=0,this._targetNodeId=null,this._iceTimeout=null,this._iceDone=!1,this._statsBindings=[],this._statsIntervalId=null,this._checkConferenceSerno=(t=>{const e=t<0||!this._lastSerno||this._lastSerno&&t===this._lastSerno+1;return e&&t>=0&&(this._lastSerno=t),e}),this._doStats=(()=>{this.peer&&this.peer.instance&&0!==this._statsBindings.length&&this.peer.instance.getStats().then(t=>{t.forEach(t=>{this._statsBindings.forEach(e=>{if(e.callback){if(e.constraints)for(var i in e.constraints)if(e.constraints.hasOwnProperty(i)&&e.constraints[i]!==t[i])return;e.callback(t)}})})})});const{iceServers:i,speaker:s,micId:n,micLabel:a,camId:o,camLabel:r,localElement:l,remoteElement:c,mediaConstraints:{audio:d,video:u},ringtoneFile:h,ringbackFile:m}=t;this.options=Object.assign({},Z,{audio:d,video:u,iceServers:i,localElement:l,remoteElement:c,micId:n,micLabel:a,camId:o,camLabel:r,speakerId:s,ringtoneFile:h,ringbackFile:m},e),this._onMediaError=this._onMediaError.bind(this),this._init(),this.options&&(this._ringtone=kt(this.options.ringtoneFile,"_ringtone"),this._ringback=kt(this.options.ringbackFile,"_ringback"))}get nodeId(){return this._targetNodeId}set nodeId(t){this._targetNodeId=t}get telnyxIDs(){return{telnyxCallControlId:this.options.telnyxCallControlId,telnyxSessionId:this.options.telnyxSessionId,telnyxLegId:this.options.telnyxLegId}}get localStream(){return this.options.localStream}get remoteStream(){return this.options.remoteStream}get memberChannel(){return"conference-member."+this.id}invite(){this.direction=G.Outbound,this.peer=new Ft(J.Offer,this.options),this._registerPeerEvents()}answer(){this.stopRingtone(),this.direction=G.Inbound,this.peer=new Ft(J.Answer,this.options),this._registerPeerEvents()}playRingtone(){xt(this._ringtone)}stopRingtone(){$t(this._ringtone)}playRingback(){xt(this._ringback)}stopRingback(){$t(this._ringback)}hangup(t,e){let i=t||{},s=!1!==e;this.cause=i.cause||"NORMAL_CLEARING",this.causeCode=i.causeCode||16,this.sipCode=i.sipCode||null,this.sipReason=i.sipReason||null,this.sipCallId=i.sip_call_id||null,this.setState(Y.Hangup);const n=()=>{this.peer&&this.peer.instance.close(),this.setState(Y.Destroy)};if(this.stopRingtone(),s){const t=new Dt({sessid:this.session.sessionid,dialogParams:this.options,cause:"USER_BUSY",causeCode:17});this._execute(t).catch(t=>p.error("telnyl_rtc.bye failed!",t)).then(n.bind(this))}else n()}transfer(t){console.warn("The call.transfer method is not currently implemented.");const e=new Ot({sessid:this.session.sessionid,action:"transfer",destination:t,dialogParams:this.options});this._execute(e)}replace(t){const e=new Ot({sessid:this.session.sessionid,action:"replace",replaceCallID:t,dialogParams:this.options});this._execute(e)}hold(){const t=new Ot({sessid:this.session.sessionid,action:"hold",dialogParams:this.options});return this._execute(t).then(this._handleChangeHoldStateSuccess.bind(this)).catch(this._handleChangeHoldStateError.bind(this))}unhold(){const t=new Ot({sessid:this.session.sessionid,action:"unhold",dialogParams:this.options});return this._execute(t).then(this._handleChangeHoldStateSuccess.bind(this)).catch(this._handleChangeHoldStateError.bind(this))}toggleHold(){const t=new Ot({sessid:this.session.sessionid,action:"toggleHold",dialogParams:this.options});return this._execute(t).then(this._handleChangeHoldStateSuccess.bind(this)).catch(this._handleChangeHoldStateError.bind(this))}dtmf(t){const e=new Rt({sessid:this.session.sessionid,dtmf:t,dialogParams:this.options});this._execute(e)}message(t,e){const i={from:this.session.options.login,to:t,body:e},s=new Rt({sessid:this.session.sessionid,msg:i,dialogParams:this.options});this._execute(s)}muteAudio(){Ct(this.options.localStream)}unmuteAudio(){wt(this.options.localStream)}toggleAudioMute(){yt(this.options.localStream)}setAudioInDevice(t){return a(this,void 0,void 0,function*(){const{instance:e}=this.peer,i=e.getSenders().find(({track:{kind:t}})=>"audio"===t);if(i){const e=yield et({audio:{deviceId:{exact:t}}}),s=e.getAudioTracks()[0];i.replaceTrack(s),this.options.micId=t;const{localStream:n}=this.options;n.getAudioTracks().forEach(t=>t.stop()),n.getVideoTracks().forEach(t=>e.addTrack(t)),this.options.localStream=e}})}muteVideo(){var t;t=this.options.localStream,bt(t,"video",!1)}unmuteVideo(){var t;t=this.options.localStream,bt(t,"video",!0)}toggleVideoMute(){var t;t=this.options.localStream,bt(t,"video",null)}setVideoDevice(t){return a(this,void 0,void 0,function*(){const{instance:e}=this.peer,i=e.getSenders().find(({track:{kind:t}})=>"video"===t);if(i){const e=yield et({video:{deviceId:{exact:t}}}),s=e.getVideoTracks()[0];i.replaceTrack(s);const{localElement:n,localStream:a}=this.options;st(n,e),this.options.camId=t,a.getAudioTracks().forEach(t=>e.addTrack(t)),a.getVideoTracks().forEach(t=>t.stop()),this.options.localStream=e}})}deaf(){Ct(this.options.remoteStream)}undeaf(){wt(this.options.remoteStream)}toggleDeaf(){yt(this.options.remoteStream)}setBandwidthEncodingsMaxBps(t,e){return a(this,void 0,void 0,function*(){if(!this||!this.peer)return void p.error("Could not set bandwidth (reason: no peer connection). Dynamic bandwidth can only be set when there is a call running - is there any call running?)");const{instance:i}=this.peer,s=i.getSenders();if(!s)return void p.error("Could not set bandwidth (reason: no senders). Dynamic bandwidth can only be set when there is a call running - is there any call running?)");const n=s.find(({track:{kind:t}})=>t===e);if(n){const i=n.getParameters();i.encodings||(i.encodings=[{rid:"h"}]),p.info("Parameters: ",i),p.info("Setting max ","audio"===e?"audio":"video"," bandwidth to: ",t," [bps]"),i.encodings[0].maxBitrate=t,yield n.setParameters(i).then(()=>{p.info("audio"===e?"New audio":"New video"," bandwidth settings in use: ",n.getParameters())}).catch(t=>console.error(t))}else p.error("Could not set bandwidth (reason: no "+e+" sender). Dynamic bandwidth can only be set when there is a call running - is there any call running?)")})}setAudioBandwidthEncodingsMaxBps(t){this.setBandwidthEncodingsMaxBps(t,"audio")}setVideoBandwidthEncodingsMaxBps(t){this.setBandwidthEncodingsMaxBps(t,"video")}getStats(t,e){if(!t)return;const i={callback:t,constraints:e};if(this._statsBindings.push(i),!this._statsIntervalId){const t=2e3;this._startStats(t)}}setState(t){switch(this._prevState=this._state,this._state=t,this.state=Y[this._state].toLowerCase(),this.prevState=Y[this._prevState].toLowerCase(),p.info(`Call ${this.id} state change from ${this.prevState} to ${this.state}`),this._dispatchNotification({type:K.callUpdate,call:this}),t){case Y.Purge:this.hangup({cause:"PURGE",causeCode:"01"},!1);break;case Y.Active:setTimeout(()=>{const{remoteElement:t,speakerId:e}=this.options;t&&e&&nt(t,e)},0);break;case Y.Destroy:this._finalize()}}handleMessage(t){const{method:e,params:i}=t;switch(e){case W.Answer:if(this.gotAnswer=!0,this._state>=Y.Active)return;this._state>=Y.Early&&this.setState(Y.Active),this.gotEarly||this._onRemoteSdp(i.sdp),this.stopRingback(),this.stopRingtone();break;case W.Media:if(this._state>=Y.Early)return;this.gotEarly=!0,this._onRemoteSdp(i.sdp);break;case W.Display:case W.Attach:{const{display_name:t,display_number:s,display_direction:n}=i;this.extension=s;const a=n===G.Inbound?G.Outbound:G.Inbound,o={type:K[e],call:this,displayName:t,displayNumber:s,displayDirection:a};D(_.Notification,o,this.id)||D(_.Notification,o,this.session.uuid);break}case W.Info:case W.Event:{const t=Object.assign(Object.assign({},i),{type:K.generic,call:this});D(_.Notification,t,this.id)||D(_.Notification,t,this.session.uuid);break}case W.Ringing:this.playRingback();break;case W.Bye:this.stopRingback(),this.stopRingtone(),this.hangup(i,!1)}}handleConferenceUpdate(t,e){return a(this,void 0,void 0,function*(){if(!this._checkConferenceSerno(t.wireSerno)&&t.name!==e.laName)return p.error("ConferenceUpdate invalid wireSerno or packet name:",t),"INVALID_PACKET";const{action:i,data:s,hashKey:n=String(this._lastSerno),arrIndex:a}=t;switch(i){case"bootObj":{this._lastSerno=0;const{chatChannel:t,infoChannel:i,modChannel:n,laName:a,conferenceMemberID:o,role:r}=e;this._dispatchConferenceUpdate({action:Q.Join,conferenceName:a,participantId:Number(o),role:r}),t&&(yield this._subscribeConferenceChat(t)),i&&(yield this._subscribeConferenceInfo(i)),n&&r===X.Moderator&&(yield this._subscribeConferenceModerator(n));const l=[];for(const t in s)l.push(Object.assign({callId:s[t][0],index:Number(t)},C(s[t][1])));this._dispatchConferenceUpdate({action:Q.Bootstrap,participants:l});break}case"add":this._dispatchConferenceUpdate(Object.assign({action:Q.Add,callId:n,index:a},C(s)));break;case"modify":this._dispatchConferenceUpdate(Object.assign({action:Q.Modify,callId:n,index:a},C(s)));break;case"del":this._dispatchConferenceUpdate(Object.assign({action:Q.Delete,callId:n,index:a},C(s)));break;case"clear":this._dispatchConferenceUpdate({action:Q.Clear});break;default:this._dispatchConferenceUpdate({action:i,data:s,callId:n,index:a})}})}_addChannel(t){this.channels.includes(t)||this.channels.push(t);const e=this.session.relayProtocol;this.session._existsSubscription(e,t)&&(this.session.subscriptions[e][t]=Object.assign(Object.assign({},this.session.subscriptions[e][t]),{callId:this.id}))}_subscribeConferenceChat(t){return a(this,void 0,void 0,function*(){const e={nodeId:this.nodeId,channels:[t],handler:t=>{const{direction:e,from:i,fromDisplay:s,message:n,type:a}=t.data;this._dispatchConferenceUpdate({action:Q.ChatMessage,direction:e,participantNumber:i,participantName:s,messageText:n,messageType:a,messageId:t.eventSerno})}},i=yield this.session.vertoSubscribe(e).catch(t=>{p.error("ConfChat subscription error:",t)});gt(i,t)&&(this._addChannel(t),Object.defineProperties(this,{sendChatMessage:{configurable:!0,value:(e,i)=>{this.session.vertoBroadcast({nodeId:this.nodeId,channel:t,data:{action:"send",message:e,type:i}})}}}))})}_subscribeConferenceInfo(t){return a(this,void 0,void 0,function*(){const e={nodeId:this.nodeId,channels:[t],handler:t=>{const{eventData:e}=t;switch(e.contentType){case"layout-info":e.callID=this.id,Bt(this.session,e);break;default:p.error("Conference-Info unknown contentType",t)}}},i=yield this.session.vertoSubscribe(e).catch(t=>{p.error("ConfInfo subscription error:",t)});gt(i,t)&&this._addChannel(t)})}_confControl(t,e={}){const i=Object.assign({application:"conf-control",callID:this.id,value:null},e);this.session.vertoBroadcast({nodeId:this.nodeId,channel:t,data:i})}_subscribeConferenceModerator(t){return a(this,void 0,void 0,function*(){const e=(e,i=null,s=null)=>{const n=parseInt(i)||null;this._confControl(t,{command:e,id:n,value:s})},i=()=>{const{video:t}=this.options;if("boolean"==typeof t&&!t||"object"==typeof t&&b(t))throw`Conference ${this.id} has no video!`},s={nodeId:this.nodeId,channels:[t],handler:t=>{const{data:e}=t;switch(e["conf-command"]){case"list-videoLayouts":if(e.responseData){const t=JSON.stringify(e.responseData).replace(/IDS"/g,'Ids"');this._dispatchConferenceUpdate({action:Q.LayoutList,layouts:JSON.parse(t)})}break;default:this._dispatchConferenceUpdate({action:Q.ModCmdResponse,command:e["conf-command"],response:e.response})}}},n=yield this.session.vertoSubscribe(s).catch(t=>{p.error("ConfMod subscription error:",t)});gt(n,t)&&(this.role=X.Moderator,this._addChannel(t),Object.defineProperties(this,{listVideoLayouts:{configurable:!0,value:()=>{e("list-videoLayouts")}},playMedia:{configurable:!0,value:t=>{e("play",null,t)}},stopMedia:{configurable:!0,value:()=>{e("stop",null,"all")}},deaf:{configurable:!0,value:t=>{e("deaf",t)}},undeaf:{configurable:!0,value:t=>{e("undeaf",t)}},startRecord:{configurable:!0,value:t=>{e("recording",null,["start",t])}},stopRecord:{configurable:!0,value:()=>{e("recording",null,["stop","all"])}},snapshot:{configurable:!0,value:t=>{i(),e("vid-write-png",null,t)}},setVideoLayout:{configurable:!0,value:(t,s)=>{i(),e("vid-layout",null,s?[t,s]:t)}},kick:{configurable:!0,value:t=>{e("kick",t)}},muteMic:{configurable:!0,value:t=>{e("tmute",t)}},muteVideo:{configurable:!0,value:t=>{i(),e("tvmute",t)}},presenter:{configurable:!0,value:t=>{i(),e("vid-res-id",t,"presenter")}},videoFloor:{configurable:!0,value:t=>{i(),e("vid-floor",t,"force")}},banner:{configurable:!0,value:(t,s)=>{i(),e("vid-banner",t,encodeURI(s))}},volumeDown:{configurable:!0,value:t=>{e("volume_out",t,"down")}},volumeUp:{configurable:!0,value:t=>{e("volume_out",t,"up")}},gainDown:{configurable:!0,value:t=>{e("volume_in",t,"down")}},gainUp:{configurable:!0,value:t=>{e("volume_in",t,"up")}},transfer:{configurable:!0,value:(t,i)=>{e("transfer",t,i)}}}))})}_handleChangeHoldStateSuccess(t){return"active"===t.holdState?this.setState(Y.Active):this.setState(Y.Held),!0}_handleChangeHoldStateError(t){return p.error(`Failed to ${t.action} on call ${this.id}`),!1}_onRemoteSdp(t){let e=ft(t,this.peer.instance.localDescription.sdp);this.options.useStereo&&(e=mt(e));const i={sdp:e,type:J.Answer};this.peer.instance.setRemoteDescription(i).then(()=>{this.gotEarly&&this.setState(Y.Early),this.gotAnswer&&this.setState(Y.Active)}).catch(t=>{p.error("Call setRemoteDescription Error: ",t),this.hangup()})}_requestAnotherLocalDescription(){S(this.peer.onSdpReadyTwice)?D(_.Error,new Error("SDP without candidates for the second time!"),this.session.uuid):(Object.defineProperty(this.peer,"onSdpReadyTwice",{value:this._onIceSdp.bind(this)}),this._iceDone=!1,this.peer.startNegotiation())}_onIceSdp(t){this._iceTimeout&&clearTimeout(this._iceTimeout),this._iceTimeout=null,this._iceDone=!0;const{sdp:e,type:i}=t;if(-1===e.indexOf("candidate"))return p.info("No candidate - retry \n"),void this._requestAnotherLocalDescription();this.peer.instance.removeEventListener("icecandidate",this._onIce);let s=null;const n={sessid:this.session.sessionid,sdp:e,dialogParams:this.options,"User-Agent":"Web-"+jt};switch(i){case J.Offer:this.setState(Y.Requesting),s=new At(n);break;case J.Answer:this.setState(Y.Answering),s=!0===this.options.attach?new Lt(n):new Tt(n);break;default:return p.error(this.id+" - Unknown local SDP type:",t),this.hangup({},!1)}this._execute(s).then(t=>{const{node_id:e=null}=t;this._targetNodeId=e,i===J.Offer?this.setState(Y.Trying):this.setState(Y.Active)}).catch(t=>{p.error(`${this.id} - Sending ${i} error:`,t),this.hangup()})}_onIce(t){const{instance:e}=this.peer;null===this._iceTimeout&&(this._iceTimeout=setTimeout(()=>this._onIceSdp(e.localDescription),1e3)),t.candidate?p.debug("RTCPeer Candidate:",t.candidate):this._onIceSdp(e.localDescription)}_registerPeerEvents(){const{instance:t}=this.peer;this._iceDone=!1,t.onicecandidate=(t=>{this._iceDone||this._onIce(t)}),t.addEventListener("addstream",t=>{this.options.remoteStream=t.stream}),t.addEventListener("track",t=>{this.options.remoteStream=t.streams[0];const{remoteElement:e,remoteStream:i,screenShare:s}=this.options;!1===s&&st(e,i)})}_onMediaError(t){this._dispatchNotification({type:K.userMediaError,error:t}),this.hangup({},!1)}_dispatchConferenceUpdate(t){this._dispatchNotification(Object.assign({type:K.conferenceUpdate,call:this},t))}_dispatchNotification(t){!0!==this.options.screenShare&&(D(_.Notification,t,this.id,!1)||D(_.Notification,t,this.session.uuid))}_execute(t){return this.nodeId&&(t.targetNodeId=this.nodeId),this.session.execute(t)}_init(){const{id:t,userVariables:e,remoteCallerNumber:i,onNotification:s}=this.options;t||(this.options.id=u()),this.id=this.options.id,e&&!b(e)||(this.options.userVariables=this.session.options.userVariables||{}),i||(this.options.remoteCallerNumber=this.options.destinationNumber),this.session.calls[this.id]=this,A(_.MediaError,this._onMediaError,this.id),S(s)&&A(_.Notification,s.bind(this),this.id),this.setState(Y.New),p.info("New Call with Options:",this.options)}_finalize(){this._stopStats(),this.peer&&this.peer.instance&&(this.peer.instance.close(),this.peer=null);const{remoteStream:t,localStream:e}=this.options;ot(t),ot(e),L(_.MediaError,null,this.id),this.session.calls[this.id]=null,delete this.session.calls[this.id]}_startStats(t){this._statsIntervalId=setInterval(this._doStats,t),p.info("Stats started")}_stopStats(){this._statsIntervalId&&(clearInterval(this._statsIntervalId),this._statsIntervalId=null),p.info("Stats stopped")}}zt.setStateTelnyx=(t=>{if(t){switch(t._state){case Y.Requesting:case Y.Recovering:case Y.Trying:case Y.Early:t.state="connecting";break;case Y.Active:t.state="active";break;case Y.Held:t.state="held";break;case Y.Hangup:case Y.Destroy:t.state="done";break;case Y.Answering:t.state="ringing";break;case Y.New:t.state="new"}return t}});class Ht extends zt{constructor(){super(...arguments),this._statsInterval=null}hangup(t={},e=!0){this.screenShare instanceof Ht&&this.screenShare.hangup(t,e),super.hangup(t,e)}startScreenShare(t){return a(this,void 0,void 0,function*(){const e=yield(i={video:!0},navigator.mediaDevices.getDisplayMedia(i));var i;e.getTracks().forEach(t=>{t.addEventListener("ended",()=>{this.screenShare&&this.screenShare.hangup()})});const{remoteCallerName:s,remoteCallerNumber:n,callerName:a,callerNumber:o}=this.options,r=Object.assign({screenShare:!0,localStream:e,destinationNumber:this.extension+"-screen",remoteCallerName:s,remoteCallerNumber:n+"-screen",callerName:a+" (Screen)",callerNumber:o+" (Screen)"},t);return this.screenShare=new Ht(this.session,r),this.screenShare.invite(),this.screenShare})}stopScreenShare(){this.screenShare instanceof Ht&&this.screenShare.hangup()}setAudioOutDevice(t){return a(this,void 0,void 0,function*(){this.options.speakerId=t;const{remoteElement:e,speakerId:i}=this.options;return!(!e||!i)&&nt(e,i)})}_finalize(){this._stats(!1),super._finalize()}_stats(t=!0){if(!1===t)return clearInterval(this._statsInterval);p.setLevel(2),this._statsInterval=window.setInterval(()=>a(this,void 0,void 0,function*(){let t="";const e=["certificate","codec","peer-connection","stream","local-candidate","remote-candidate"],i=["id","type","timestamp"];(yield this.peer.instance.getStats(null)).forEach(s=>{e.includes(s.type)||(t+=`\n${s.type}\n`,Object.keys(s).forEach(e=>{i.includes(e)||(t+=`\t${e}: ${s[e]}\n`)}))}),p.info(t)}),2e3)}}class Jt extends Nt{constructor(){super(),this.method=W.GatewayState;const t={method:W.GatewayState,jsonrpc:"2.0",params:{}};this.buildRequest({method:this.method,params:t})}}class Gt{constructor(t){this.session=t,this.retriedRegister=0}_ack(t,e){const i=new Pt(t,e);this.nodeId&&(i.targetNodeId=this.nodeId),this.session.execute(i)}handleMessage(t){const{session:e}=this,{id:i,method:s,params:n}=t,{callID:a,eventChannel:o,eventType:r}=n,l=s===W.Attach;if("channelPvtData"===r)return this._handlePvtEvent(n.pvtData);if(a&&e.calls.hasOwnProperty(a)){if(!l)return e.calls[a].handleMessage(t),void this._ack(i,s);e.calls[a].hangup({},!1)}const c=()=>{const t={id:a,remoteSdp:n.sdp,destinationNumber:n.callee_id_number,remoteCallerName:n.caller_id_name,remoteCallerNumber:n.caller_id_number,callerName:n.callee_id_name,callerNumber:n.callee_id_number,attach:l,mediaSettings:n.mediaSettings};n.telnyx_call_control_id&&(t.telnyxCallControlId=n.telnyx_call_control_id),n.telnyx_session_id&&(t.telnyxSessionId=n.telnyx_session_id),n.telnyx_leg_id&&(t.telnyxLegId=n.telnyx_leg_id),n.client_state&&(t.clientState=n.client_state);const i=new Ht(e,t);return i.nodeId=this.nodeId,i},d=new Jt;switch(s){case W.Punt:e.disconnect();break;case W.Invite:{const t=c();t.playRingtone(),t.setState(Y.Ringing),this._ack(i,s);break}case W.Attach:{const e=c();this.session.autoRecoverCalls?e.answer():e.setState(Y.Recovering),e.handleMessage(t);break}case W.Event:case"webrtc.event":if(!o)return void p.error("Verto received an unknown event:",n);const a=e.relayProtocol,r=o.split(".")[0];e._existsSubscription(a,o)?D(a,n,o):o===e.sessionid?this._handleSessionEvent(n.eventData):e._existsSubscription(a,r)?D(a,n,r):e.calls.hasOwnProperty(o)?e.calls[o].handleMessage(t):D(_.Notification,n,e.uuid);break;case W.Info:n.type=K.generic,D(_.Notification,n,e.uuid);break;case W.ClientReady:this.session.execute(d);break;case W.GatewayState:if(t.params&&t.params.state&&"REGED"===t.params.state){this.retriedRegister=0,n.type=K.vertoClientReady,D(_.Notification,n,e.uuid);break}if(t.params&&t.params.state&&"NOREG"===t.params.state){if(this.retriedRegister+=1,3===this.retriedRegister){this.retriedRegister=0,D(_.Error,n,e.uuid);break}this.session.execute(d)}break;default:p.warn("Verto message unknown method:",t)}}_retrieveCallId(t,e){const i=Object.keys(this.session.calls);if("bootObj"!==t.action)return i.find(t=>this.session.calls[t].channels.includes(e));{const e=t.data.find(t=>i.includes(t[0]));if(e instanceof Array)return e[0]}}_handlePvtEvent(t){return a(this,void 0,void 0,function*(){const{session:e}=this,i=e.relayProtocol,{action:s,laChannel:n,laName:a,chatChannel:o,infoChannel:r,modChannel:l,conferenceMemberID:c,role:d,callID:u}=t;switch(s){case"conference-liveArray-join":{const i=()=>{e.vertoBroadcast({nodeId:this.nodeId,channel:n,data:{liveArray:{command:"bootstrap",context:n,name:a}}})},s={nodeId:this.nodeId,channels:[n],handler:({data:s})=>{const o=u||this._retrieveCallId(s,n);if(o&&e.calls.hasOwnProperty(o)){const r=e.calls[o];r._addChannel(n),r.extension=a,r.handleConferenceUpdate(s,t).then(t=>{"INVALID_PACKET"===t&&i()})}}},o=yield e.vertoSubscribe(s).catch(t=>{p.error("liveArray subscription error:",t)});gt(o,n)&&i();break}case"conference-liveArray-part":{let t=null;if(n&&e._existsSubscription(i,n)){const{callId:s=null}=e.subscriptions[i][n];if(t=e.calls[s]||null,null!==s){const i={type:K.conferenceUpdate,action:Q.Leave,conferenceName:a,participantId:Number(c),role:d};D(_.Notification,i,s,!1)||D(_.Notification,i,e.uuid),null===t&&L(_.Notification,null,s)}}const s=[n,o,r,l];e.vertoUnsubscribe({nodeId:this.nodeId,channels:s}).then(({unsubscribedChannels:e=[]})=>{t&&(t.channels=t.channels.filter(t=>!e.includes(t)))}).catch(t=>{p.error("liveArray unsubscribe error:",t)});break}}})}_handleSessionEvent(t){switch(t.contentType){case"layout-info":case"layer-info":Bt(this.session,t);break;case"logo-info":{const e={type:K.conferenceUpdate,action:Q.LogoInfo,logo:t.logoURL};D(_.Notification,e,this.session.uuid);break}}}}class Wt extends class extends class extends class{constructor(t){if(this.options=t,this.uuid=u(),this.sessionid="",this.subscriptions={},this.signature=null,this.relayProtocol=null,this.contexts=[],this.timeoutErrorCode=-32e3,this.connection=null,this._jwtAuth=!1,this._doKeepAlive=!1,this._autoReconnect=!0,this._idle=!1,this._executeQueue=[],!this.validateOptions())throw new Error("Invalid init options");this._onSocketOpen=this._onSocketOpen.bind(this),this._onSocketCloseOrError=this._onSocketCloseOrError.bind(this),this._onSocketMessage=this._onSocketMessage.bind(this),this._handleLoginError=this._handleLoginError.bind(this),this._attachListeners(),this.connection=new B(this)}get __logger(){return p}get connected(){return this.connection&&this.connection.connected}get reconnectDelay(){return 1e3*(6,2,Math.floor(-3*Math.random()+6))}execute(t){return this._idle?new Promise(e=>this._executeQueue.push({resolve:e,msg:t})):this.connected?this.connection.send(t).catch(t=>{throw t.code&&t.code===this.timeoutErrorCode&&this._closeConnection(),t}):new Promise(e=>{this._executeQueue.push({resolve:e,msg:t}),this.connect()})}executeRaw(t){this._idle?this._executeQueue.push({msg:t}):this.connection.sendRawText(t)}validateOptions(){return I(this.options)}broadcast(t){}disconnect(){return a(this,void 0,void 0,function*(){clearTimeout(this._reconnectTimeout),this.subscriptions={},this._autoReconnect=!1,this.relayProtocol=null,this._closeConnection(),yield H(this.signature),this._executeQueue=[],this._detachListeners()})}on(t,e){return A(t,e,this.uuid),this}off(t,e){return L(t,e,this.uuid),this}connect(){return a(this,void 0,void 0,function*(){this.connection||(this.connection=new B(this)),this._attachListeners(),this.connection.isAlive||this.connection.connect()})}_handleLoginError(t){D(_.Error,t,this.uuid)}_onSocketOpen(){return a(this,void 0,void 0,function*(){})}_onSocketCloseOrError(t){p.error(`Socket ${t.type} ${t.message}`),this.relayProtocol&&O(this.relayProtocol);for(const t in this.subscriptions)O(t);this.subscriptions={},this.contexts=[],this._autoReconnect&&(this._reconnectTimeout=setTimeout(()=>this.connect(),this.reconnectDelay))}_onSocketMessage(t){}_removeSubscription(t,e){this._existsSubscription(t,e)&&(e?(delete this.subscriptions[t][e],L(t,null,e)):(delete this.subscriptions[t],O(t)))}_addSubscription(t,e=null,i){this._existsSubscription(t,i)||(this._existsSubscription(t)||(this.subscriptions[t]={}),this.subscriptions[t][i]={},S(e)&&A(t,e,i))}_existsSubscription(t,e){return!(!this.subscriptions.hasOwnProperty(t)||!(!e||e&&this.subscriptions[t].hasOwnProperty(e)))}_attachListeners(){this._detachListeners(),this.on(_.SocketOpen,this._onSocketOpen),this.on(_.SocketClose,this._onSocketCloseOrError),this.on(_.SocketError,this._onSocketCloseOrError),this.on(_.SocketMessage,this._onSocketMessage)}_detachListeners(){this.off(_.SocketOpen,this._onSocketOpen),this.off(_.SocketClose,this._onSocketCloseOrError),this.off(_.SocketError,this._onSocketCloseOrError),this.off(_.SocketMessage,this._onSocketMessage)}_emptyExecuteQueues(){this._executeQueue.forEach(({resolve:t,msg:e})=>{"string"==typeof e?this.executeRaw(e):t(this.execute(e))})}_closeConnection(){this._idle=!0,clearTimeout(this._keepAliveTimeout),this.connection&&this.connection.close()}_keepAlive(){if(!0===this._doKeepAlive){if(!1===this._pong)return this._closeConnection();this._pong=!1,this._keepAliveTimeout=setTimeout(()=>this._keepAlive(),1e4)}}static on(t,e){A(t,e)}static off(t){L(t)}static uuid(){return u()}}{constructor(t){super(t),this.calls={},this.autoRecoverCalls=!0,this._iceServers=[],this._localElement=null,this._remoteElement=null,this._jwtAuth=!0,this._audioConstraints=!0,this._videoConstraints=!1,this._speaker=null,this.iceServers=t.iceServers,this.ringtoneFile=t.ringtoneFile,this.ringbackFile=t.ringbackFile}get reconnectDelay(){return 1e3}connect(){const t=Object.create(null,{connect:{get:()=>super.connect}});return a(this,void 0,void 0,function*(){this.sessionid=yield j("sessId"),t.connect.call(this)})}checkPermissions(t=!0,e=!0){return a(this,void 0,void 0,function*(){try{const i=yield rt({audio:t,video:e});return ot(i),!0}catch(t){return!1}})}logout(){this.disconnect()}disconnect(){const t=Object.create(null,{disconnect:{get:()=>super.disconnect}});return a(this,void 0,void 0,function*(){Object.keys(this.calls).forEach(t=>this.calls[t].setState(Y.Purge)),this.calls={},yield t.disconnect.call(this)})}speedTest(t){return new Promise((e,i)=>{if(T(_.SpeedTest,i=>{const{upDur:s,downDur:n}=i,a=n?8*t/(n/1e3)/1024:0;e({upDur:s,downDur:n,upKps:(s?8*t/(s/1e3)/1024:0).toFixed(0),downKps:a.toFixed(0)})},this.uuid),!(t=Number(t)))return i("Invalid parameter 'bytes': "+t);this.executeRaw("#SPU "+t);let s=t/1024;t%1024&&s++;const n=".".repeat(1024);for(let t=0;t<s;t++)this.executeRaw("#SPB "+n);this.executeRaw("#SPE")})}getDevices(){return lt().catch(t=>(D(_.MediaError,t,this.uuid),[]))}getVideoDevices(){return lt(tt.Video).catch(t=>(D(_.MediaError,t,this.uuid),[]))}getAudioInDevices(){return lt(tt.AudioIn).catch(t=>(D(_.MediaError,t,this.uuid),[]))}getAudioOutDevices(){return lt(tt.AudioOut).catch(t=>(console.error("getAudioOutDevices",t),D(_.MediaError,t,this.uuid),[]))}validateDeviceId(t,e,i){return dt(t,e,i)}getDeviceResolutions(t){return a(this,void 0,void 0,function*(){try{return yield(t=>a(void 0,void 0,void 0,function*(){const e=[],i=yield rt({video:{deviceId:{exact:t}}}),s=i.getVideoTracks()[0];for(let t=0;t<ct.length;t++){const[i,n]=ct[t];(yield s.applyConstraints({width:{exact:i},height:{exact:n}}).then(()=>!0).catch(()=>!1))&&e.push({resolution:`${i}x${n}`,width:i,height:n})}return ot(i),e}))(t)}catch(t){throw t}})}get mediaConstraints(){return{audio:this._audioConstraints,video:this._videoConstraints}}setAudioSettings(t){return a(this,void 0,void 0,function*(){if(!t)throw new Error("You need to provide the settings object");const{micId:e,micLabel:i}=t,s=n(t,["micId","micLabel"]);return ut(s),this._audioConstraints=yield ht(e,i,"audioinput",s),this.micId=e,this.micLabel=i,this._audioConstraints})}disableMicrophone(){this._audioConstraints=!1}enableMicrophone(){this._audioConstraints=!0}setVideoSettings(t){return a(this,void 0,void 0,function*(){if(!t)throw new Error("You need to provide the settings object");const{camId:e,camLabel:i}=t,s=n(t,["camId","camLabel"]);return ut(s),this._videoConstraints=yield ht(e,i,"videoinput",s),this.camId=e,this.camLabel=i,this._videoConstraints})}disableWebcam(){this._videoConstraints=!1}enableWebcam(){this._videoConstraints=!0}set iceServers(t){this._iceServers="boolean"==typeof t?t?[{urls:["stun:stun.l.google.com:19302"]}]:[]:t||[g,f]}get iceServers(){return this._iceServers}set speaker(t){this._speaker=t}get speaker(){return this._speaker}set localElement(t){this._localElement=k(t)}get localElement(){return this._localElement}set remoteElement(t){this._remoteElement=k(t)}get remoteElement(){return this._remoteElement}vertoBroadcast({nodeId:t,channel:e="",data:i}){if(!e)throw new Error("Invalid channel for broadcast: "+e);const s=new Mt({sessid:this.sessionid,eventChannel:e,data:i});t&&(s.targetNodeId=t),this.execute(s).catch(t=>t)}vertoSubscribe({nodeId:t,channels:e=[],handler:i}){return a(this,void 0,void 0,function*(){if(!(e=e.filter(t=>t&&!this._existsSubscription(this.relayProtocol,t))).length)return{};const s=new qt({sessid:this.sessionid,eventChannel:e});t&&(s.targetNodeId=t);const n=yield this.execute(s),{unauthorized:a=[],subscribed:o=[]}=_t(n);return a.length&&a.forEach(t=>this._removeSubscription(this.relayProtocol,t)),o.forEach(t=>this._addSubscription(this.relayProtocol,i,t)),n})}vertoUnsubscribe({nodeId:t,channels:e=[]}){return a(this,void 0,void 0,function*(){if(!(e=e.filter(t=>t&&this._existsSubscription(this.relayProtocol,t))).length)return{};const i=new Ut({sessid:this.sessionid,eventChannel:e});t&&(i.targetNodeId=t);const s=yield this.execute(i),{unsubscribed:n=[],notSubscribed:a=[]}=_t(s);return n.forEach(t=>this._removeSubscription(this.relayProtocol,t)),a.forEach(t=>this._removeSubscription(this.relayProtocol,t)),s})}static telnyxStateCall(t){return Ht.setStateTelnyx(t)}}{constructor(){super(...arguments),this.relayProtocol="verto-protocol",this.timeoutErrorCode=-329990}validateOptions(){return I(this.options)}newCall(t){if(!t||!t.destinationNumber)throw new Error("Verto.newCall() error: destinationNumber is required.");const e=new Ht(this,t);return e.invite(),e}broadcast(t){return this.vertoBroadcast(t)}subscribe(t){return this.vertoSubscribe(t)}unsubscribe(t){return this.vertoUnsubscribe(t)}_onSocketOpen(){return a(this,void 0,void 0,function*(){this._idle=!1;const{login:t,password:e,passwd:i,login_token:s,userVariables:n}=this.options,a=new Et(t,e||i,s,this.sessionid,n),o=yield this.execute(a).catch(this._handleLoginError);o&&(this._autoReconnect=!0,this.sessionid=o.sessid,z("sessId",this.sessionid),D(_.Ready,this,this.uuid),p.info("Session Ready!"))})}_onSocketMessage(t){new Gt(this).handleMessage(t)}}{constructor(t){super(t)}newCall(t){return super.newCall(t)}static webRTCInfo(){return function(){try{const{browserInfo:t,name:e,version:i,supportAudio:s,supportVideo:n}=function(){if(!window||!window.navigator||!window.navigator.userAgent)throw new Error("You should use @telnyx/webrtc in a web browser such as Chrome|Firefox|Safari");if(navigator.userAgent.match(/chrom(e|ium)/gim)&&!navigator.userAgent.match(/OPR\/[0-9]{2}/gi)&&!navigator.userAgent.match(/edg/gim)){const t=navigator.userAgent.match(/chrom(e|ium)\/[0-9]+\./gim)[0].split("/"),e=t[0],i=parseInt(t[1],10);return{browserInfo:navigator.userAgent,name:e,version:i,supportAudio:!0,supportVideo:!0}}if(navigator.userAgent.match(/firefox/gim)&&!navigator.userAgent.match(/OPR\/[0-9]{2}/gi)&&!navigator.userAgent.match(/edg/gim)){const t=navigator.userAgent.match(/firefox\/[0-9]+\./gim)[0].split("/"),e=t[0],i=parseInt(t[1],10);return{browserInfo:navigator.userAgent,name:e,version:i,supportAudio:!0,supportVideo:!1}}if(navigator.userAgent.match(/safari/gim)&&!navigator.userAgent.match(/OPR\/[0-9]{2}/gi)&&!navigator.userAgent.match(/edg/gim)){const t=navigator.userAgent.match(/safari/gim)[0],e=navigator.userAgent.match(/version\/[0-9]+\./gim)[0].split("/"),i=parseInt(e[1],10);return{browserInfo:navigator.userAgent,name:t,version:i,supportAudio:!0,supportVideo:!0}}if(navigator.userAgent.match(/edg/gim)&&!navigator.userAgent.match(/OPR\/[0-9]{2}/gi)){const t=navigator.userAgent.match(/edg\/[0-9]+\./gim)[0].split("/"),e=t[0],i=parseInt(t[1],10);return{browserInfo:navigator.userAgent,name:e,version:i,supportAudio:!0,supportVideo:!0}}throw new Error("This browser does not support @telnyx/webrtc. To see browser support list: `TelnyxRTC.webRTCSupportedBrowserList()`")}(),a=window.RTCPeerConnection,o=window.RTCSessionDescription,r=window.RTCIceCandidate,l=window.navigator&&window.navigator.mediaDevices,c=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;return{browserInfo:t,browserName:e,browserVersion:i,supportWebRTC:!!(a&&o&&r&&l&&c),supportWebRTCAudio:s,supportWebRTCVideo:n,supportRTCPeerConnection:!!a,supportSessionDescription:!!o,supportIceCandidate:!!r,supportMediaDevices:!!l,supportGetUserMedia:!!rt}}catch(t){return t.message}}()}static webRTCSupportedBrowserList(){return[{operationSystem:"Android",supported:[{browserName:"Chrome",features:["audio"],supported:St.full},{browserName:"Firefox",features:["audio"],supported:St.partial},{browserName:"Safari",supported:St.not_supported},{browserName:"Edge",supported:St.not_supported}]},{operationSystem:"iOS",supported:[{browserName:"Chrome",supported:St.not_supported},{browserName:"Firefox",supported:St.not_supported},{browserName:"Safari",features:["video","audio"],supported:St.full},{browserName:"Edge",supported:St.not_supported}]},{operationSystem:"Linux",supported:[{browserName:"Chrome",features:["video","audio"],supported:St.full},{browserName:"Firefox",features:["audio"],supported:St.partial},{browserName:"Safari",supported:St.not_supported},{browserName:"Edge",supported:St.not_supported}]},{operationSystem:"MacOS",supported:[{browserName:"Chrome",features:["video","audio"],supported:St.full},{browserName:"Firefox",features:["audio"],supported:St.partial},{browserName:"Safari",features:["video","audio"],supported:St.full},{browserName:"Edge",features:["audio"],supported:St.partial}]},{operationSystem:"Windows",supported:[{browserName:"Chrome",features:["video","audio"],supported:St.full},{browserName:"Firefox",features:["audio"],supported:St.partial},{browserName:"Safari",supported:St.not_supported},{browserName:"Edge",features:["audio"],supported:St.partial}]}]}}}).call(e,i("DuR2"),i("W2nU"))},"2b2A":function(t,e){},"3vHc":function(t,e){},"6JOO":function(t,e){},"7hMv":function(t,e){},"9M+g":function(t,e){},"A7/c":function(t,e){},BNMf:function(t,e){},CuRo:function(t,e){},DB4i:function(t,e){},IzAl:function(t,e){},Jmt5:function(t,e){},LH4P:function(t,e){},LpFZ:function(t,e){},M9yh:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("7+uW"),n=i("bOdI"),a=i.n(n),o=i("//Fk"),r=i.n(o),l=i("mtWM"),c=i.n(l),d=i("aLYK"),u={init:function(){var t="";"http://localhost:8080"===window.location.origin&&(t="http://localhost:3000"),console.log(t),s.default.use(d.a,c.a),s.default.axios.defaults.baseURL=t+"/api"},setHeader:function(){var t=s.default.cookie.get("access_token");s.default.axios.defaults.headers.common.token=""+t},query:function(t,e){return s.default.axios.get(t,e).catch(function(t){throw console.log(t),new Error("ApiService "+t)})},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.axios.get(t+"/"+e).catch(function(t){throw new Error("ApiService "+t)})},post:function(t,e){return s.default.axios.post(""+t,e)},update:function(t,e,i){return s.default.axios.put(t+"/"+e,i)},put:function(t,e){return s.default.axios.put(""+t,e)},delete:function(t){return s.default.axios.delete(t).catch(function(t){throw new Error("[RWV] ApiService "+t)})}},h=i("/ocq"),m=i("ESwS"),p=i.n(m),v=i("mvHQ"),f=i.n(v),g={props:["idHide"],mounted:function(){var t=localStorage.getItem("user-theme"),e=void 0;e=t||this.getMediaPreference(),this.setTheme(e)},data:function(){return{userTheme:"light-theme"}},methods:{toggleTheme:function(){"light-theme"===localStorage.getItem("user-theme")?this.setTheme("dark-theme"):this.setTheme("light-theme")},setTheme:function(t){localStorage.setItem("user-theme",t),this.userTheme=t,document.documentElement.className=t},getMediaPreference:function(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark-theme":"light-theme"}}},_={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return"false"===t.idHide?i("div",[i("input",{staticClass:"switch-checkbox",attrs:{id:"checkbox",type:"checkbox"},on:{change:t.toggleTheme}}),t._v(" "),i("label",{staticClass:"switch-label switch-label-mode",attrs:{for:"checkbox"}},[i("span",[t._v("🌙")]),t._v(" "),i("span",[t._v("☀️")]),t._v(" "),i("div",{staticClass:"switch-toggle",class:{"switch-toggle-checked":"dark-theme"===t.userTheme}})])]):t._e()},staticRenderFns:[]};var b=i("VU/8")(g,_,!1,function(t){i("M9yh")},"data-v-33e956ec",null).exports,w=i("+cKO"),C={name:"Login",components:{ThemeButton:b},data:function(){return{baseurl:"",switch1:!0,otpScreen:!1,otpError:!1,loginId:0,signUpOption:!1,versionOption:"v1.0.0",user:{email:"",password:""},otpForm:{otp:""},submitted:!1,submitted2:!1}},validations:{user:{email:{required:w.required,minLength:Object(w.minLength)(2)},password:{required:w.required,minLength:Object(w.minLength)(6)}}},mounted:function(){this.$cookie.get("access_token")&&this.$router.push("/dashboard"),this.getsignup(),this.getVersion()},methods:{getsignup:function(){var t=this;this.$store.dispatch(ee,{data:{},url:"auth/get-signup"}).then(function(e){"on"===e.data?t.signUpOption=!0:t.signUpOption=!1}).catch(function(e){t.signUpOption=!1})},getVersion:function(){var t=this;this.$store.dispatch(ee,{data:{},url:"auth/get-version"}).then(function(e){t.versionOption=e.data}).catch(function(t){})},handleSubmit:function(t){var e=this;if(t.preventDefault(),this.submitted=!0,this.$v.$touch(),!this.$v.$invalid){var i={data:this.user,url:"auth/login"};this.$store.dispatch(ee,i).then(function(t){e.$cookie.set("access_token",t.token,30),e.$cookie.set("userdata",f()(t.data),30),console.log(e.$cookie.get("access_token")),console.log(e.$cookie.get("userdata")),e.$router.push("/dashboard")}).catch(function(t){})}}}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"login-box dark-mode p-3"},[i("theme-button",{attrs:{"id-hide":"false"}}),t._v(" "),i("h1",{staticClass:"dark-mode"},[t._v("Login")]),t._v(" "),t.otpScreen?t._e():i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-4"},[i("b-input-group",[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("b-icon",{attrs:{icon:"person-fill"}})],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control chat-input",class:{"is-invalid":t.submitted&&t.$v.user.email.$error},attrs:{type:"text",placeholder:"Username",id:"login-input"},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.email.required?t._e():i("span",[t._v("Username is required")]),t._v(" "),t.$v.user.email.minLength?t._e():i("span",[t._v("Username is invalid")])]):t._e()],1),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4"},[i("b-input-group",[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("b-icon",{attrs:{icon:"shield-lock"}})],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"chat-input form-control",class:{"is-invalid":t.submitted&&t.$v.user.password.$error},attrs:{type:"password",placeholder:"Password",id:"login-input"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():i("span",[t._v("Password is required")]),t._v(" "),t.$v.user.password.minLength?t._e():i("span",[t._v("Password is invalid")])]):t._e()],1),t._v(" "),t._m(0),t._v(" "),t.signUpOption?i("div",{staticClass:"my-2 small"},[t._v("\n            Don’t have an account yet? "),i("router-link",{staticClass:"mx-2",attrs:{to:"/signup"}},[t._v(" Sign up")])],1):i("div",{staticClass:"d-grid d-md-flex mt-2 small"},[t._v("\n            New registrations are disabled\n          ")])]),t._v(" "),i("form",{staticClass:"ml-2 mr-2",class:{"d-none":!t.otpScreen}},[i("div",{staticClass:"form-group mb-2 mt-4"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.otpForm.otp,expression:"otpForm.otp"}],staticClass:"chat-input form-control",class:{"is-invalid":t.submitted2&&t.otpError},attrs:{type:"text",placeholder:"OTP"},domProps:{value:t.otpForm.otp},on:{input:function(e){e.target.composing||t.$set(t.otpForm,"otp",e.target.value)}}}),t._v(" "),t.submitted2&&t.otpError?i("div",{staticClass:"invalid-feedback"},[i("span",[t._v("OTP is required")])]):t._e()]),t._v(" "),t._m(1)]),t._v(" "),i("div",{staticClass:"d-flex my-4 justify-content-center"},[i("a",{attrs:{href:"https://www.twitter.com/0perationP",target:"_blank","aria-label":"Twitter",title:"Twitter"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"twitter",variant:"secondary"}})],1),t._v(" "),i("a",{attrs:{href:"https://github.com/0perationPrivacy/",target:"_blank","aria-label":"Github",title:"Github"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"github",variant:"secondary"}})],1),t._v(" "),i("a",{attrs:{href:"https://www.OperationPrivacy.com/Donate",target:"_blank","aria-label":"Donate",title:"Donate"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"credit-card",variant:"secondary"}})],1)])],1),t._v(" "),i("p",{staticClass:"version"},[t._v(t._s(t.versionOption))])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-grid"},[e("button",{staticClass:"btn btn-success mt-3",attrs:{type:"submit",id:"login-button"}},[this._v("Login")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-grid d-md-flex"},[e("button",{staticClass:"btn btn-success mt-3",attrs:{type:"button",id:"login-button"}},[this._v("Submit")])])}]};var S=i("VU/8")(C,y,!1,function(t){i("BNMf")},"data-v-50a4436c",null).exports,k={name:"Signup",data:function(){return{version:Object({NODE_ENV:"production"}).VERSION,user:{email:"",password:""},submitted:!1,baseurl:""}},validations:{user:{email:{required:w.required,minLength:Object(w.minLength)(2)},password:{required:w.required,minLength:Object(w.minLength)(6)},c_password:{required:w.required,sameAsPassword:Object(w.sameAs)("password")}}},mounted:function(){"http://localhost:8080"===window.location.origin&&(this.baseurl="http://localhost:3000"),this.getsignup()},methods:{handleSubmit:function(t){var e=this;t.preventDefault(),this.submitted=!0,this.$v.$touch(),this.$v.$invalid||axios.post("auth/register",this.user).then(function(t){e.$router.push("/")}).catch(function(t){401===t.response.status&&e.$swal({icon:"error",title:"Oops...",text:t.response.data.message}),400===t.response.status&&e.$swal({icon:"error",title:"Oops...",text:t.response.data.errors.errors.email[0]})})},getsignup:function(){var t=this;axios.post(this.baseurl+"/api/auth/get-signup",{}).then(function(e){"on"===e.data.data?t.signUpOption=!0:t.$router.push("/")}).catch(function(){t.signUpOption=!1})}}},x={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"login-box dark-mode p-3"},[i("h1",{staticClass:"dark-mode"},[t._v("Signup")]),t._v(" "),i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-4"},[i("b-input-group",[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("b-icon",{attrs:{icon:"person-fill"}})],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control chat-input",class:{"is-invalid":t.submitted&&t.$v.user.email.$error},attrs:{type:"text",placeholder:"Username",id:"login-input"},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.email.required?t._e():i("span",[t._v("Username is required")]),t._v(" "),t.$v.user.email.minLength?t._e():i("span",[t._v("Please enter a valid Username")])]):t._e()],1),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4"},[i("b-input-group",[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("b-icon",{attrs:{icon:"shield-lock"}})],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"chat-input form-control",class:{"is-invalid":t.submitted&&t.$v.user.password.$error},attrs:{type:"password",placeholder:"Password",id:"login-input"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():i("span",[t._v("Password is required")]),t._v(" "),t.$v.user.password.minLength?t._e():i("span",[t._v("Please enter a valid password")])]):t._e()],1),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-2"},[i("b-input-group",[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("b-icon",{attrs:{icon:"shield-lock"}})],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.c_password,expression:"user.c_password"}],staticClass:"chat-input form-control",class:{"is-invalid":t.submitted&&t.$v.user.c_password.$error},attrs:{type:"password",placeholder:"Confirm Password",id:"clogin-input"},domProps:{value:t.user.c_password},on:{input:function(e){e.target.composing||t.$set(t.user,"c_password",e.target.value)}}})],1),t._v(" "),t.submitted&&t.$v.user.c_password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.c_password.required?t._e():i("span",[t._v("Password is required"),i("br")]),t._v(" "),t.$v.user.c_password.sameAsPassword?t._e():i("span",[t._v("Password and confirm password are not match!")])]):t._e()],1),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"my-2 small"},[t._v("\n            Already have an account? "),i("router-link",{staticClass:"mx-2",attrs:{to:"/"}},[t._v("Login")])],1)]),t._v(" "),i("div",{staticClass:"d-flex my-4 justify-content-center"},[i("a",{attrs:{href:"https://www.twitter.com/0perationP",target:"_blank","aria-label":"Twitter",title:"Twitter"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"twitter",variant:"secondary"}})],1),t._v(" "),i("a",{attrs:{href:"https://github.com/0perationPrivacy/",target:"_blank","aria-label":"Github",title:"Github"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"github",variant:"secondary"}})],1),t._v(" "),i("a",{attrs:{href:"https://www.OperationPrivacy.com/Donate",target:"_blank","aria-label":"Donate",title:"Donate"}},[i("b-icon",{staticClass:"mx-2",attrs:{"font-scale":"2",icon:"credit-card",variant:"secondary"}})],1)])]),t._v(" "),i("p",{staticClass:"version"},[t._v(t._s(t.version))])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-grid"},[e("button",{staticClass:"btn btn-primary mt-3",attrs:{type:"submit"}},[this._v("Sign Up")])])}]};var $=i("VU/8")(k,x,!1,function(t){i("/hSy")},"data-v-62d67784",null).exports,I=i("Gu7T"),N=i.n(I),E=new s.default,P={data:function(){return{access_token:null,headers:null,baseurl:"",profiles:[],activeProfile:null,submitted3:!1,isLoading:!1,form:{profile:""}}},validations:{form:{profile:{required:w.required}}},mounted:function(){this.userdata=JSON.parse(this.$cookie.get("userdata")),this.access_token=this.$cookie.get("access_token"),this.headers={headers:{token:this.access_token}},"http://localhost:8080"===window.location.origin&&(this.baseurl="http://localhost:3000"),this.getallProfile()},methods:{onClickButton:function(t){this.$emit("clicked",t)},changeProfile:function(t){this.activeProfile=t,localStorage.setItem("activeProfile",f()(t)),this.$emit("clicked",t),E.$emit("clicked",!0),E.$emit("changeProfile",!0)},activeFirstProfile:function(){this.profiles.length>0?this.changeProfile(this.profiles[0]):(this.activeProfile=null,this.$emit("clicked",null))},getallProfile:function(){var t=this;this.$store.dispatch(ee,{data:{},url:"profile/getdata"}).then(function(e){if(t.profiles=e.data,!t.activeProfile){var i=localStorage.getItem("activeProfile");if(i)for(var s=JSON.parse(i),n=0;n<t.profiles.length;n++)t.profiles[n]._id===s._id&&(t.activeProfile=t.profiles[n]);else t.activeProfile=t.profiles[0];t.$emit("clicked",t.activeProfile)}}).catch(function(t){console.log(t)})},handleSubmit:function(t){var e=this;if(this.submitted3=!0,E.$emit("toggleLoader",!0),this.$v.$touch(),!this.$v.$invalid){var i={data:this.form,url:"profile/create"};this.$store.dispatch(ee,i).then(function(t){e.$swal({icon:"success",title:"Success",text:"Profile added successfully!"}),e.changeProfile(t.data),e.$refs["add-profile"].hide(),e.getallProfile(),e.isLoading=!1,E.$emit("toggleLoader",!0)}).catch(function(t){console.log(t),e.isLoading=!1,E.$emit("toggleLoader",!0)})}}}},A={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isLoading?i("div",{attrs:{id:"loader1"}},[t._m(0)]):t._e(),t._v(" "),t._l(t.profiles,function(e){return i("div",{key:e._id},[i("b-dropdown-item-button",{on:{click:function(i){return t.changeProfile(e)}}},[i("div",{staticClass:"d-flex flex-row"},[i("div",[i("div",{staticClass:"d-flex flex-column"},[i("div",[t._v("\n              "+t._s(e.profile)+"\n            ")]),t._v(" "),i("div",[e.number&&""!==e.number?i("span",{staticClass:"profileNum"},[t._v("("+t._s(e.number)+")")]):t._e()])])]),t._v(" "),i("div",[e.messageCount>0?i("span",{staticClass:"start-100 translate-middle badge border border-light rounded-circle bg-danger p-2"},[i("span",{staticClass:"visually-hidden"},[t._v("unread messages")])]):t._e()])])]),t._v(" "),i("b-dropdown-divider")],1)}),t._v(" "),i("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.add-profile",modifiers:{"add-profile":!0}}]},[i("b-icon",{attrs:{icon:"person-plus-fill","aria-hidden":"true"}}),t._v("\n      Add New Profile\n  ")],1),t._v(" "),i("b-dropdown-divider"),t._v(" "),i("b-modal",{ref:"add-profile",attrs:{id:"add-profile",size:"lg",title:"Add Profile","hide-footer":""}},[i("span",{staticClass:"small text-secondary"},[t._v("Profile")]),t._v(" "),i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.profile,expression:"form.profile"}],staticClass:"form-control chat-input",class:{"is-invalid":t.submitted3&&t.$v.form.profile.$error},attrs:{name:"profile",placeholder:"Enter Profile"},domProps:{value:t.form.profile},on:{input:function(e){e.target.composing||t.$set(t.form,"profile",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.profile.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.profile.required?t._e():i("span",[t._v("Profile are required")])]):t._e()]),t._v(" "),i("div",{staticClass:"d-grid d-md-flex mt-3"},[i("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Save")])])])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex loader justify-content-center align-items-center"},[e("div",{staticClass:"sp sp-circle"})])}]};var T=i("VU/8")(P,A,!1,function(t){i("LpFZ")},"data-v-13f963de",null).exports,L=i("pFYg"),D=i.n(L),O=i("Xxa5"),R=i.n(O),M=i("exGp"),q=i.n(M),U=i("afOB"),F=i.n(U),B=w.helpers.regex("phonenumber",/^\+?[0-9\(\-\)\ ]{5,17}$/),V={props:["contacts"],data:function(){return{access_token:null,headers:null,baseurl:"",modelFileValu:"",submitted:!1,userdata:null,editId:!1,csvFile:null,submitted2:!1,search_contacts:[],form:{first_name:"",last_name:"",number:"",note:""},query:"",jsonData:[{first_name:"John",last_name:"Doe",number:"12300XXXXX",note:"notes go here"}],csvUploadArray2:[]}},validations:{form:{first_name:{required:w.required},last_name:{},number:{required:w.required,phonenumber:B},note:{}}},mounted:function(){var t=this;E.$on("addContact",function(e){t.editId=!1,t.emptyContact(),t.$refs["modal-contact"].show(),t.form.number=e})},methods:{exportContact:function(){this.downloadFile(this.contacts,"contacts")},emptyContact:function(){this.form.first_name="",this.form.last_name="",this.form.number="",this.form.note=""},onSelect:function(t){var e=this;return q()(R.a.mark(function i(){var s,n;return R.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e.csvFile=!0,console.log(t),e.modelFileValu=t.target.files[0].name,s=t.target.files[0],i.next=6,e.readFile(s);case 6:n=i.sent,e.csvUploadArray2=n,console.log(e.csvUploadArray2);case 9:case"end":return i.stop()}},i,e)}))()},readFile:function(t){var e=this;return new r.a(function(i,s){var n=new FileReader;n.readAsText(t,"UTF-8"),n.onload=function(t){var s=t.target.result,n={complete:function(t,i){e.csvUploadArray=t.data}};F.a.parse(s,n);for(var a=[],o=e.csvUploadArray,r=0;r<o.length;++r)if(0!==r&&""!==o[r][0]&&void 0!==o[r][0]&&isNaN(o[r][0])){var l={first_name:o[r][0],last_name:o[r][1],number:o[r][2],note:o[r][3]};a.push(l)}i(a)}})},choseFile2:function(){document.getElementById("model_file_input2").click()},downloadFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",i=this.ConvertToCSV(t,["first_name","last_name","number","note"]);console.log(i);var s=new Blob(["\ufeff"+i],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(s);-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&n.setAttribute("target","_blank"),n.setAttribute("href",a),n.setAttribute("download",e+".csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},download:function(){this.downloadFile(this.jsonData,"sample_file")},ConvertToCSV:function(t,e){var i="object"!==(void 0===t?"undefined":D()(t))?JSON.parse(t):t,s="",n="";for(var a in e)console.log(a),console.log(e[a]),n+=e[a]+",";s+=(n=n.slice(0,-1))+"\r\n";for(var o=0;o<i.length;o++){var r="";for(var l in e){var c=e[l];r+=i[o][c]+","}s+=r+"\r\n"}return s},openContactModel:function(){this.editId=!1,this.emptyContact(),this.$refs["modal-contact"].show()},handleSubmit:function(t){var e=this;if(this.submitted=!0,this.$v.$touch(),!this.$v.$invalid){if(this.editId){var i=this.form;i.contact_id=this.editId;var s={data:i,url:"contact/update"}}else s={data:this.form,url:"contact/create"};this.$store.dispatch(ee,s).then(function(t){e.$refs["modal-contact"].hide(),e.$emit("onaddContact",!0),E.$emit("contactAdded",e.form.number),e.emptyContact(),e.submitted=!1}).catch(function(t){console.log(t)})}},handleSubmit2:function(){var t=this;if(this.csvUploadArray2.length>0){var e={data:{contacts:this.csvUploadArray2},url:"contact/multiple-add"};this.$store.dispatch(ee,e).then(function(e){t.$refs["modal-contact"].hide(),t.$emit("onaddContact",!0),t.modelFileValu=""}).catch(function(t){console.log(t)})}else this.$swal({icon:"error",title:"Error",text:"Please upload valid file!"})},deletechat:function(t){var e=this;this.$swal.fire({icon:"info",title:"Do you want to delete this contact?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Delete",denyButtonText:"No"}).then(function(i){if(i.isConfirmed){var s={data:{contact_id:t},url:"contact/delete"};e.$store.dispatch(ee,s).then(function(t){e.$swal({icon:"success",title:"Success",text:"Contact Deleted successfully!"}),e.$emit("onaddContact",!0),E.$emit("contactAdded","delete")}).catch(function(t){console.log(t)})}else i.isDenied&&e.$swal.fire("contact not deleted","","info")})},updateContact:function(t){this.editId=t._id,this.form={first_name:t.first_name,last_name:t.last_name,number:t.number,note:t.note},this.$refs["modal-contact"].show()},deleteAll:function(){var t=this;this.$swal.fire({icon:"info",title:"Are you sure you want to delete ALL contacts?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Delete all",denyButtonText:"No"}).then(function(e){if(e.isConfirmed){t.$store.dispatch(ee,{data:{},url:"contact/deleteall"}).then(function(e){t.$swal({icon:"success",title:"Success",text:"All contacts deleted successfully"}),t.$emit("onaddContact",!0)}).catch(function(t){console.log(t)})}else e.isDenied&&t.$swal.fire("contacts not deleted","","info")})},searchContact:function(){var t=new RegExp(this.query,"i");this.search_contacts=this.contacts.filter(function(e){return t.test(e.first_name)?t.test(e.first_name):t.test(e.last_name)?t.test(e.last_name):t.test(e.number)?t.test(e.number):void 0})}},watch:{contacts:function(t,e){this.searchContact()}}},j={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-icon",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-right",modifiers:{"sidebar-right":!0}}],staticClass:"pointer-icon m-2",attrs:{"font-scale":"1",icon:"person-lines-fill","aria-hidden":"true",title:"Contacts"}}),t._v(" "),i("b-sidebar",{attrs:{id:"sidebar-right",right:"",shadow:"","no-header":"",backdrop:""},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.hide;return[i("div",{staticClass:"d-flex flex-row mt-2 justify-content-between bd-highlight"},[i("div",{staticClass:"bd-highlight dropDown"},[i("b-button",{staticClass:"float-left d-flex m-1",attrs:{size:"sm",variant:"primary"}},[i("b-icon",{attrs:{icon:"x",scale:"1"},on:{click:s}})],1)],1),t._v(" "),i("div",[i("div",{staticClass:"d-flex justify-content-start"},[i("div",{staticClass:"ml-1"},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"float-left d-flex m-1",attrs:{title:"Add Contact",size:"sm",variant:"primary"},on:{click:function(e){return t.openContactModel()}}},[i("b-icon",{attrs:{icon:"plus-circle",scale:"1"}})],1)],1),t._v(" "),i("div",{staticClass:"ml-2"},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"float-left d-flex m-1",attrs:{title:"Export Contact",size:"sm",variant:"primary"},on:{click:function(e){return t.exportContact()}}},[i("b-icon",{attrs:{icon:"cloud-download",scale:"1"}})],1)],1),t._v(" "),i("div",{staticClass:"ml-2"},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"float-left d-flex m-1",attrs:{title:"Delete All Contact",size:"sm",variant:"danger"},on:{click:function(e){return t.deleteAll()}}},[i("b-icon",{attrs:{icon:"trash-fill",scale:"1"}})],1)],1),t._v(" "),i("div",[i("h4",{staticClass:"pr-3 m-1"},[t._v("\n                                Contacts\n                            ")])])])])]),t._v(" "),i("div",[i("div",{staticClass:"wrap-search"},[i("div",{staticClass:"search"},[i("div",{staticClass:"d-flex flex-row bd-highlight"},[i("div",{staticClass:"bd-highlight"},[t._v("\n                        "),i("b-icon",{attrs:{icon:"search"}}),t._v("  \n                    ")],1),t._v(" "),i("div",{staticClass:"bd-highlight"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"input-search",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.query},on:{keyup:function(e){return t.searchContact()},input:function(e){e.target.composing||(t.query=e.target.value)}}})])])])]),t._v(" "),i("ul",{staticClass:"list-group"},t._l(t.search_contacts,function(e){return i("li",{key:e._id,staticClass:"list-group-item d-flex justify-content-between align-items-center"},[i("div",{staticClass:"d-flex flex-column bd-highlight"},[i("div",{staticClass:"bd-highlight"},[t._v("\n                      "+t._s(e.first_name)+" "+t._s(e.last_name)+"\n                    ")]),t._v(" "),i("div",{staticClass:"bd-highlight"},[t._v(t._s(e.number))])]),t._v(" "),i("div",[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"pencil-square",title:"Update"},on:{click:function(i){return t.updateContact(e)}}}),t._v(" "),i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"trash-fill",title:"Delete"},on:{click:function(i){return t.deletechat(e._id)}}})],1)])}),0)])]}}])}),t._v(" "),i("b-modal",{ref:"modal-contact",attrs:{id:"modal-contact",title:"Contact","hide-footer":""}},[i("div",{staticClass:"card mt-4"},[i("div",{staticClass:"card-body"},[i("b-tabs",{attrs:{"content-class":"mt-3"}},[i("b-tab",{attrs:{title:"Add Contact",active:""}},[i("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:" form-group m-auto mb-2"},[i("label",[t._v("First Name")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.first_name,expression:"form.first_name"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.form.first_name.$error},attrs:{type:"text",placeholder:"First Name",id:"first_name",name:"first_name"},domProps:{value:t.form.first_name},on:{input:function(e){e.target.composing||t.$set(t.form,"first_name",e.target.value)}}}),t._v(" "),t.submitted&&!t.$v.form.first_name.required?i("div",{staticClass:"invalid-feedback"},[t._v("First Name is required")]):t._e()]),t._v(" "),i("div",{staticClass:"form-group m-auto mb-2"},[i("label",[t._v("Last Name")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.last_name,expression:"form.last_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Last Name",id:"last_name",name:"last_name"},domProps:{value:t.form.last_name},on:{input:function(e){e.target.composing||t.$set(t.form,"last_name",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group m-auto mb-2"},[i("label",[t._v("Number")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.number,expression:"form.number"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.form.number.$error},attrs:{type:"text",placeholder:"Number",id:"number",name:"number"},domProps:{value:t.form.number},on:{input:function(e){e.target.composing||t.$set(t.form,"number",e.target.value)}}}),t._v(" "),t.submitted&&!t.$v.form.number.required?i("div",{staticClass:"invalid-feedback"},[t._v("Number is required")]):t._e(),t._v(" "),t.submitted&&!t.$v.form.number.phonenumber?i("div",{staticClass:"invalid-feedback"},[t._v("Please enter valid number. ")]):t._e()]),t._v(" "),i("div",{staticClass:"form-group m-auto mb-2"},[i("label",[t._v("Note")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.note,expression:"form.note"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Note",id:"note",name:"note"},domProps:{value:t.form.note},on:{input:function(e){e.target.composing||t.$set(t.form,"note",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"d-flex justify-content-start bd-highlight"},[i("div",{staticClass:"bd-highlight"},[i("button",{staticClass:"btn btn-primary float-right",attrs:{type:"submit"}},[t._v("Save")])])])])]),t._v(" "),i("b-tab",{attrs:{title:"Add Multiple"}},[i("div",{staticClass:"d-flex justify-content-end"},[i("button",{staticClass:"btn btn-success mb-2 float-right",on:{click:function(e){return t.download()}}},[t._v("Sample File")])]),t._v(" "),i("div",{staticClass:"input-group mb-3"},[i("div",{staticClass:"input-group-prepend"},[i("span",{staticClass:"input-group-text paperClip chat-input",attrs:{id:"basic-addon1"},on:{click:function(e){return t.choseFile2()}}},[i("b-icon",{attrs:{icon:"paperclip"}})],1)]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.modelFileValu,expression:"modelFileValu"}],staticClass:"form-control csv_field_input chat-input",attrs:{type:"text",placeholder:"Choose file","aria-label":"Username",readonly:"","aria-describedby":"basic-addon1"},domProps:{value:t.modelFileValu},on:{click:function(e){return t.choseFile2()},input:function(e){e.target.composing||(t.modelFileValu=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4 d-none"},[i("input",{staticClass:"form-control chat-input",attrs:{type:"file",id:"model_file_input2",name:"csvFile",accept:".csv"},on:{change:function(e){return t.onSelect(e)}}})]),t._v(" "),i("div",{staticClass:"d-flex justify-content-start bd-highlight"},[i("div",{staticClass:"bd-highlight"},[i("button",{staticClass:"btn btn-primary float-right",attrs:{type:"button"},on:{click:function(e){return t.handleSubmit2()}}},[t._v("Save")])])])])],1)],1)])])],1)},staticRenderFns:[]};var z=i("VU/8")(V,j,!1,function(t){i("SNJk")},"data-v-4b530c2e",null).exports,H=i("5Q7Q"),J=i.n(H),G={data:function(){return{form:{email:"",sender_email:"",password:"",to_email:"",host:"",port:"",secure:!1},submitted3:!1,showProfile:!1,profiles:[]}},validations:{form:{email:{required:w.required},sender_email:{required:w.required,email:w.email},password:{required:w.required},to_email:{required:w.required,email:w.email},host:{required:w.required},port:{required:w.required}}},mounted:function(){this.getEmailSetting()},methods:{handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i={data:this.form,url:"email/create"};this.$store.dispatch(ee,i).then(function(t){console.log(t),e.$swal({icon:"success",title:"Email Setting",text:"Setting saved successfully"}),e.getEmailSetting()}).catch(function(t){console.log(t)})}},getEmailSetting:function(){var t=this;this.$store.dispatch(ie,{url:"email/get"}).then(function(e){console.log(e),e.data?(t.form=e.data,t.showProfile=!0,t.getProfiles()):(t.form.email="",t.form.password="",t.form.to_email="",t.form.host="",t.form.port="",t.form.secure=!1,t.form.sender_email="")}).catch(function(t){console.log(t)})},getProfiles:function(){var t=this;this.$store.dispatch(ee,{data:{},url:"profile/getdata"}).then(function(e){console.log(e),t.profiles=e.data}).catch(function(t){console.log(t)})},profileUpdate:function(t,e){var i=this,s={data:{setting_id:e,status:t},url:"email/save/setting"};this.$store.dispatch(ee,s).then(function(t){i.getProfiles()}).catch(function(t){console.log(t)})}}},W={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-1"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.email.$error},attrs:{name:"email",placeholder:"Enter Username"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.email.required?t._e():i("span",[t._v("Email Is Required")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.password.$error},attrs:{name:"password",placeholder:"Enter Password"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.password.required?t._e():i("span",[t._v("Password Is Required")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sender_email,expression:"form.sender_email"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.sender_email.$error},attrs:{name:"sender_email",placeholder:"Enter Sender Email"},domProps:{value:t.form.sender_email},on:{input:function(e){e.target.composing||t.$set(t.form,"sender_email",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.to_email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.sender_email.required?t._e():i("span",[t._v("Sender Email is required")]),t._v(" "),t.$v.form.sender_email.email?t._e():i("span",[t._v("Enter Valid Sender Email")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.to_email,expression:"form.to_email"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.to_email.$error},attrs:{name:"to_email",placeholder:"Enter From Email"},domProps:{value:t.form.to_email},on:{input:function(e){e.target.composing||t.$set(t.form,"to_email",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.to_email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.to_email.required?t._e():i("span",[t._v("To Email is required")]),t._v(" "),t.$v.form.to_email.email?t._e():i("span",[t._v("Enter Valid To Email")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.host,expression:"form.host"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.host.$error},attrs:{name:"host",placeholder:"Enter Host (smtp.domain.com)"},domProps:{value:t.form.host},on:{input:function(e){e.target.composing||t.$set(t.form,"host",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.host.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.host.required?t._e():i("span",[t._v("Host Is Required")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.port,expression:"form.port"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.port.$error},attrs:{name:"port",placeholder:"Enter Port (465 or 587)"},domProps:{value:t.form.port},on:{input:function(e){e.target.composing||t.$set(t.form,"port",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.port.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.port.required?t._e():i("span",[t._v("Port Is Required")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("b-form-checkbox",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.bottomright",value:"for 465 only",expression:"'for 465 only'",modifiers:{hover:!0,bottomright:!0}}],attrs:{id:"checkbox-11",name:"secure",value:!0,plain:"",checked:"true",variant:"primary"},model:{value:t.form.secure,callback:function(e){t.$set(t.form,"secure",e)},expression:"form.secure"}},[t._v("\n            Secure\n          ")])],1),t._v(" "),t._m(0)]),t._v(" "),i("hr"),t._v(" "),t.showProfile?i("div",[i("div",{staticClass:"form-group mt-2"},t._l(t.profiles,function(e){return i("b-form-checkbox",{key:e._id,attrs:{plain:"",id:"checkbox-1",name:"checkbox-1",value:"true","unchecked-value":"false",checked:"true"==e.emailnotification},on:{change:function(i){return t.profileUpdate(i,e._id)}}},[i("span",{staticClass:"pr-2"},[t._v("  "+t._s(e.profile))])])}),1)]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Save")])])}]};var K=i("VU/8")(G,W,!1,function(t){i("LH4P")},null,null).exports,Z=w.helpers.regex("phonenumber",/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/),Y={data:function(){return{form:{voice_url:"",voice_main_url:"",sms_url:"",sms_main_url:""},submitted3:!1,setting:null}},validations:{form:{voice_url:{required:w.required,url:Z},sms_url:{required:w.required,url:Z}}},mounted:function(){this.getCallSetting()},methods:{getCallSetting:function(){var t=this,e=localStorage.getItem("activeProfile");if(e){var i=JSON.parse(e);this.setting=i._id;var s={data:{setting_id:this.setting},url:"setting/twilio/number/get"};this.$store.dispatch(ee,s).then(function(e){console.log(e.data),t.form.voice_main_url=e.data.voiceUrl,t.form.sms_main_url=e.data.smsUrl,e.data.voiceFallbackUrl&&(t.form.voice_url=e.data.voiceFallbackUrl),e.data.smsFallbackUrl&&(t.form.sms_url=e.data.smsFallbackUrl)}).catch(function(t){console.log(t)})}},handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i=this.form;i.setting_id=this.setting;var s={data:i,url:"setting/twilio/number/fallback"};this.$store.dispatch(ee,s).then(function(t){e.$swal({icon:"success",title:"Success",text:"Number Setting updated successfully!"}),e.getCallSetting()}).catch(function(t){console.log(t)})}}}},X={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-1 px-2"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("A CALL COMES IN")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.voice_main_url,expression:"form.voice_main_url"}],staticClass:"form-control main-url-control",attrs:{name:"voice_main_url",readonly:""},domProps:{value:t.form.voice_main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"voice_main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("CALL HANDLER FAILS")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.voice_url,expression:"form.voice_url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.voice_url.$error},attrs:{name:"url",placeholder:"Enter Twiml Fallback Url"},domProps:{value:t.form.voice_url},on:{input:function(e){e.target.composing||t.$set(t.form,"voice_url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.voice_url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.voice_url.required?t._e():i("span",[t._v("Url Is Required")]),t._v(" "),t.$v.form.voice_url.url?t._e():i("span",[t._v("Please enter valid Url")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("A MESSAGE COMES IN")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sms_main_url,expression:"form.sms_main_url"}],staticClass:"form-control main-url-control",attrs:{name:"sms_main_url",readonly:""},domProps:{value:t.form.sms_main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"sms_main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("MESSAGE HANDLER FAILS")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sms_url,expression:"form.sms_url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.sms_url.$error},attrs:{name:"sms_url",placeholder:"Enter Twiml Fallback Url"},domProps:{value:t.form.sms_url},on:{input:function(e){e.target.composing||t.$set(t.form,"sms_url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.sms_url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.sms_url.required?t._e():i("span",[t._v("Url Is Required")]),t._v(" "),t.$v.form.sms_url.url?t._e():i("span",[t._v("Please enter valid Url")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Update")])])}]};var Q=i("VU/8")(Y,X,!1,function(t){i("7hMv")},"data-v-375ee342",null).exports,tt=w.helpers.regex("phonenumber",/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/),et={data:function(){return{form:{url:"",main_url:""},submitted3:!1,setting:null}},validations:{form:{url:{required:w.required,url:tt}}},mounted:function(){this.getCallSetting()},methods:{getCallSetting:function(){var t=this,e=localStorage.getItem("activeProfile");if(e){var i=JSON.parse(e);this.setting=i._id;var s={data:{setting_id:this.setting},url:"setting/twilio/twiml/get"};this.$store.dispatch(ee,s).then(function(e){var i=new URL(e.data.voiceUrl),s=i.hostname,n=i.protocol;if(t.form.main_url=n+"//"+s,e.data.voiceFallbackUrl){var a=new URL(e.data.voiceFallbackUrl),o=a.hostname,r=a.protocol;t.form.url=r+"//"+o}}).catch(function(t){console.log(t)})}},handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i=this.form;i.setting_id=this.setting;var s={data:i,url:"setting/twilio/twiml/fallback"};this.$store.dispatch(ee,s).then(function(t){e.$swal({icon:"success",title:"Success",text:"TwiML Setting updated successfully!"}),e.getCallSetting()}).catch(function(t){console.log(t)})}}}},it={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-1 px-2"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Request URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.main_url,expression:"form.main_url"}],staticClass:"form-control main-url-control",attrs:{name:"main_url",readonly:""},domProps:{value:t.form.main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Fallback URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.url.$error},attrs:{name:"url",placeholder:"Enter Fallback Url"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.url.required?t._e():i("span",[t._v("Twiml Fallback Url Is Required")]),t._v(" "),t.$v.form.url.url?t._e():i("span",[t._v("Please enter valid Twiml Fallback Url")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Update")])])}]};var st=i("VU/8")(et,it,!1,function(t){i("v5Fl")},"data-v-6652bd0a",null).exports,nt={components:{TwilioNumberSetting:Q,TwimlSetting:st},data:function(){return{activeMenu:"setting"}},mounted:function(){},methods:{enableMenu:function(t){this.activeMenu=t}}},at={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-2"},["setting"==t.activeMenu?i("div",[i("ul",{staticClass:"list-group"},[i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("twiml")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"gear-fill","font-scale":"1","aria-hidden":"true"}}),t._v("TwiML Setting\n      ")],1),t._v(" "),i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("number")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"telephone","font-scale":"1","aria-hidden":"true"}}),t._v("Number Setting\n      ")],1)])]):t._e(),t._v(" "),"twiml"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(0),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("twiml-setting")],1):t._e(),t._v(" "),"number"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(1),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("twilio-number-setting")],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h6",[this._v("TwiML Setting")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p-2 bd-highlight"},[e("h6",[this._v("Number Setting")])])}]};var ot=i("VU/8")(nt,at,!1,function(t){i("3vHc")},null,null).exports,rt=w.helpers.regex("phonenumber",/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/),lt={data:function(){return{form:{url:"",main_url:""},submitted3:!1,setting:null}},validations:{form:{url:{required:w.required,url:rt}}},mounted:function(){this.getCallSetting()},methods:{getCallSetting:function(){var t=this,e=localStorage.getItem("activeProfile");if(e){var i=JSON.parse(e);this.setting=i._id;var s={data:{setting_id:this.setting},url:"setting/telnyx/sip/get"};this.$store.dispatch(ee,s).then(function(e){t.form.main_url=e.data.data.webhook_event_url,e.data.data.webhook_event_failover_url&&(t.form.url=e.data.data.webhook_event_failover_url)}).catch(function(t){console.log(t)})}},handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i=this.form;i.setting_id=this.setting;var s={data:i,url:"setting/telnyx/sip/fallback"};this.$store.dispatch(ee,s).then(function(t){e.$swal({icon:"success",title:"Success",text:"SIP Setting updated successfully!"}),e.getCallSetting()}).catch(function(t){console.log(t)})}}}},ct={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-1 px-2"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Webhook URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.main_url,expression:"form.main_url"}],staticClass:"form-control main-url-control",attrs:{name:"main_url",readonly:""},domProps:{value:t.form.main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Webhook Fallback URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.url.$error},attrs:{name:"url",placeholder:"Enter Twiml Fallback Url"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.url.required?t._e():i("span",[t._v("Twiml Fallback Url Is Required")]),t._v(" "),t.$v.form.url.url?t._e():i("span",[t._v("Please enter valid Twiml Fallback Url")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Update")])])}]};var dt=i("VU/8")(lt,ct,!1,function(t){i("XBCt")},"data-v-815b5f8a",null).exports,ut=w.helpers.regex("phonenumber",/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/),ht={data:function(){return{form:{url:"",main_url:""},submitted3:!1,setting:null}},validations:{form:{url:{required:w.required,url:ut}}},mounted:function(){this.getCallSetting()},methods:{getCallSetting:function(){var t=this,e=localStorage.getItem("activeProfile");if(e){var i=JSON.parse(e);this.setting=i._id;var s={data:{setting_id:this.setting},url:"setting/telnyx/twiml/get"};this.$store.dispatch(ee,s).then(function(e){t.form.main_url=e.data.data.voice_url,e.data.data.voice_fallback_url&&(t.form.url=e.data.data.voice_fallback_url)}).catch(function(t){console.log(t)})}},handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i=this.form;i.setting_id=this.setting;var s={data:i,url:"setting/telnyx/twiml/fallback"};this.$store.dispatch(ee,s).then(function(t){e.$swal({icon:"success",title:"Success",text:"TeXML Setting updated successfully!"}),e.getCallSetting()}).catch(function(t){console.log(t)})}}}},mt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-1 px-2"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Webhook URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.main_url,expression:"form.main_url"}],staticClass:"form-control main-url-control",attrs:{name:"main_url",readonly:""},domProps:{value:t.form.main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Webhook Fallback URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.url.$error},attrs:{name:"url",placeholder:"Enter Webhook Fallback URL"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.url.required?t._e():i("span",[t._v(" Url Is Required")]),t._v(" "),t.$v.form.url.url?t._e():i("span",[t._v("Please enter valid Url")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Update")])])}]};var pt=i("VU/8")(ht,mt,!1,function(t){i("6JOO")},"data-v-08e81282",null).exports,vt=w.helpers.regex("phonenumber",/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/),ft={data:function(){return{form:{url:"",main_url:""},submitted3:!1,setting:null}},validations:{form:{url:{required:w.required,url:vt}}},mounted:function(){this.getCallSetting()},methods:{getCallSetting:function(){var t=this,e=localStorage.getItem("activeProfile");if(e){var i=JSON.parse(e);this.setting=i._id;var s={data:{setting_id:this.setting},url:"setting/telnyx/message/get"};this.$store.dispatch(ee,s).then(function(e){var i=new URL(e.data.data.webhook_url),s=i.hostname,n=i.protocol;if(t.form.main_url=n+"//"+s,e.data.data.webhook_failover_url){var a=new URL(e.data.data.webhook_failover_url),o=a.hostname,r=a.protocol;t.form.url=r+"//"+o}}).catch(function(t){console.log(t)})}},handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i=this.form,s=new URL(i.url),n=s.hostname,a=s.protocol;i.url=a+"//"+n,i.setting_id=this.setting;var o={data:i,url:"setting/telnyx/message/fallback"};this.$store.dispatch(ee,o).then(function(t){e.$swal({icon:"success",title:"Success",text:" Profile updated successfully!"}),e.getCallSetting()}).catch(function(t){console.log(t)})}}}},gt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-1 px-2"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Primary Webhook URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.main_url,expression:"form.main_url"}],staticClass:"form-control main-url-control",attrs:{name:"main_url",readonly:""},domProps:{value:t.form.main_url},on:{input:function(e){e.target.composing||t.$set(t.form,"main_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Webhook Fallback URL")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.url.$error},attrs:{name:"url",placeholder:"Enter Webhook Fallback URL"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.url.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.url.required?t._e():i("span",[t._v(" Url Is Required")]),t._v(" "),t.$v.form.url.url?t._e():i("span",[t._v("Please enter valid Url")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Update")])])}]};var _t=i("VU/8")(ft,gt,!1,function(t){i("IzAl")},"data-v-bfc9b4fe",null).exports,bt={components:{SipSetting:dt,TexmlSetting:pt,MessageSetting:_t},data:function(){return{activeMenu:"setting"}},mounted:function(){},methods:{enableMenu:function(t){this.activeMenu=t}}},wt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-2"},[i("div",[i("div",{staticClass:"d-flex justify-content-between"},[i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("message-setting")],1),t._v(" "),"twiml"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(0),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("texml-setting")],1):t._e(),t._v(" "),"sip"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(1),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("sip-setting")],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h6",[this._v("TwiML Setting")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p-2 bd-highlight"},[e("h6",[this._v("SIP Setting")])])}]};var Ct={components:{TwilioSetting:ot,TelnyxSetting:i("VU/8")(bt,wt,!1,function(t){i("2b2A")},null,null).exports,MessageSetting:_t,TwimlSetting:st},data:function(){return{setting:null,activeMenu:"setting"}},mounted:function(){E.$on("changeProfile",this.getCallSetting),this.getCallSetting()},methods:{getCallSetting:function(){var t=localStorage.getItem("activeProfile");if(t){var e=JSON.parse(t);this.setting=e}},enableMenu:function(t){this.activeMenu=t}}},yt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this.setting&&"twilio"===this.setting.type?e("div",[e("twiml-setting")],1):this._e(),this._v(" "),this.setting&&"telnyx"===this.setting.type?e("div",[e("message-setting")],1):this._e()])},staticRenderFns:[]},St=i("VU/8")(Ct,yt,!1,null,null,null).exports,kt={data:function(){return{form:{email:""},submitted3:!1}},validations:{form:{email:{required:w.required}}},mounted:function(){var t=JSON.parse(this.$cookie.get("userdata"));void 0!==t.email&&(this.form.email=t.email)},methods:{handleSubmit:function(t){var e=this;if(this.submitted3=!0,this.$v.$touch(),!this.$v.$invalid){var i={data:this.form,url:"auth/username/update"};this.$store.dispatch(ee,i).then(function(t){t&&(e.$cookie.set("userdata",f()(t.data),30),e.$swal({icon:"success",title:"Success",text:"Username updated successfully"}))}).catch(function(t){console.log(t)})}}}},xt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-1"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.submitted3&&t.$v.form.email.$error},attrs:{name:"email",placeholder:"Enter Username"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),t._v(" "),t.submitted3&&t.$v.form.email.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.form.email.required?t._e():i("span",[t._v("Email Is Required")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Change")])])}]},$t=i("VU/8")(kt,xt,!1,null,null,null).exports,It={data:function(){return{user:{old_password:"",password:"",c_password:""},submitted:!1}},validations:{user:{old_password:{required:w.required},password:{required:w.required,minLength:Object(w.minLength)(6)},c_password:{required:w.required,sameAsPassword:Object(w.sameAs)("password")}}},mounted:function(){},methods:{handleSubmit:function(t){var e=this;if(this.submitted=!0,this.$v.$touch(),!this.$v.$invalid){var i={data:this.user,url:"auth/password/update"};this.$store.dispatch(ee,i).then(function(t){t&&(e.$swal({icon:"success",title:"Success",text:"Password updated successfully"}),e.submitted=!1,e.user={password:"",c_password:""})}).catch(function(t){console.log(t)})}}}},Nt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-1"},[i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"form-group mb-2 mt-4"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.old_password,expression:"user.old_password"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.old_password.$error},attrs:{name:"password",type:"password",placeholder:"Old Password"},domProps:{value:t.user.old_password},on:{input:function(e){e.target.composing||t.$set(t.user,"old_password",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.old_password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.old_password.required?t._e():i("span",[t._v("old Password is required")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.password.$error},attrs:{type:"password",placeholder:"New Password",id:"login-input"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():i("span",[t._v("Password is required")]),t._v(" "),t.$v.user.password.minLength?t._e():i("span",[t._v("Please enter a valid password")])]):t._e()]),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.c_password,expression:"user.c_password"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.c_password.$error},attrs:{type:"password",placeholder:"Confirm Password",id:"clogin-input"},domProps:{value:t.user.c_password},on:{input:function(e){e.target.composing||t.$set(t.user,"c_password",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.c_password.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.c_password.required?t._e():i("span",[t._v("Confirm Password is required"),i("br")]),t._v(" "),t.$v.user.c_password.sameAsPassword?t._e():i("span",[t._v("Password and confirm password are not match!")])]):t._e()]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-success mt-2",attrs:{type:"submit"}},[this._v("Change")])])}]},Et={components:{ChangeUsername:$t,ChangePassword:i("VU/8")(It,Nt,!1,null,null,null).exports,CallSetting:St},data:function(){return{activeMenu:"setting"}},mounted:function(){},methods:{enableMenu:function(t){this.activeMenu=t},deleteAccount:function(){var t=this;this.$swal.fire({icon:"warning",text:"Please enter your account password to delete account. This process is irreversible",title:"Delete Account",input:"password",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Submit",showLoaderOnConfirm:!0,preConfirm:function(e){var i={data:{password:e},url:"auth/password/check"};return t.$store.dispatch(ee,i).then(function(t){return t}).catch(function(t){return!1})},allowOutsideClick:function(){return!t.$swal.isLoading()}}).then(function(e){console.log(e),e.isConfirmed&&t.$swal.fire({icon:"success",title:"Account Delete",text:"Your account deleted successfully",showDenyButton:!1,showCancelButton:!1,confirmButtonText:"Ok"}).then(function(e){t.$cookie.delete("access_token"),t.$cookie.delete("userdata"),window.location.href="/"})})}}},Pt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"p-2"},["setting"==t.activeMenu?i("div",[i("ul",{staticClass:"list-group"},[i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("username")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"person","font-scale":"1","aria-hidden":"true"}}),t._v("Change Username\n      ")],1),t._v(" "),i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("password")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"key","font-scale":"1","aria-hidden":"true"}}),t._v("Change Password\n      ")],1),t._v(" "),i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.deleteAccount()}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"trash","font-scale":"1","aria-hidden":"true"}}),t._v("Delete Account\n      ")],1),t._v(" "),i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("fallback")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"exclamation-circle","font-scale":"1","aria-hidden":"true"}}),t._v("Fallback Setting\n      ")],1)])]):t._e(),t._v(" "),"username"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(0),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("change-username")],1):t._e(),t._v(" "),"password"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(1),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("change-password")],1):t._e(),t._v(" "),"fallback"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[t._m(2),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"1","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("call-setting")],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h6",[this._v("Change Username")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p-2 bd-highlight"},[e("h6",[this._v("Change Password")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p-2 bd-highlight"},[e("h6",[this._v("Fallback Setting")])])}]};var At={components:{EmailSetting:K,CallSetting:St,AccountSetting:i("VU/8")(Et,Pt,!1,function(t){i("A7/c")},null,null).exports},data:function(){return{activeMenu:"setting"}},mounted:function(){},methods:{enableMenu:function(t){this.activeMenu=t}}},Tt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-icon",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-email-setting",modifiers:{"sidebar-email-setting":!0}}],staticClass:"m-2",staticStyle:{cursor:"pointer"},attrs:{"font-scale":"1",icon:"gear-fill","aria-hidden":"true",title:"Settings"}}),t._v(" "),i("b-sidebar",{attrs:{id:"sidebar-email-setting",title:"Settings",shadow:"",backdrop:""}},["setting"==t.activeMenu?i("div",{staticClass:"px-3 py-2"},[i("ul",{staticClass:"list-group"},[i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("email")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"envelope","font-scale":"1","aria-hidden":"true"}}),t._v("Email Settings")],1),t._v(" "),i("li",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],staticClass:"list-group-item",staticStyle:{cursor:"pointer"}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"person-badge","font-scale":"1","aria-hidden":"true"}}),t._v("Profile Settings\n            ")],1),t._v(" "),i("li",{staticClass:"list-group-item",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.enableMenu("account")}}},[i("b-icon",{staticClass:"mx-2",attrs:{icon:"person","font-scale":"1","aria-hidden":"true"}}),t._v("Account Settings\n            ")],1)])]):t._e(),t._v(" "),"email"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[i("div",[i("h4",[t._v("Email Settings")])]),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"2","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("email-setting")],1):t._e(),t._v(" "),"call"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[i("div",{staticClass:"p-2 bd-highlight"},[i("h4",[t._v("Call Settings")])]),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"2","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("call-setting")],1):t._e(),t._v(" "),"profile"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[i("div",{staticClass:"p-2 bd-highlight"},[i("h4",[t._v("Profile Settings")])]),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"2","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v("\n          Profile settings\n        ")]):t._e(),t._v(" "),"account"==t.activeMenu?i("div",[i("div",{staticClass:"d-flex justify-content-between"},[i("div",{staticClass:"p-2 bd-highlight"},[i("h4",[t._v("Account Settings")])]),t._v(" "),i("div",{staticClass:"p-2 bd-highlight"},[i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-left","font-scale":"2","aria-hidden":"true"},on:{click:function(e){return t.enableMenu("setting")}}})],1)]),t._v(" "),i("div",[i("account-setting")],1)]):t._e()])],1)},staticRenderFns:[]};var Lt=i("VU/8")(At,Tt,!1,function(t){i("DB4i")},null,null).exports,Dt={components:{ProfileView:T,ThemeButton:b,Contact:z,Setting:Lt},data:function(){return{user:{api_key:"",number:"",twilio_sid:"",twilio_token:"",twilio_number:"",profile:""},query:"",isLoading:!1,contacts:[],activeChat:"",submitted:!1,messageListLoader:!0,numbers:[],search_numbers:[],baseurl:"",userdata:null,access_token:null,activeProfile:null,headers:null,tNumbers:[],twilioNumbers:[],activeItem:null,options:[{text:"Telnyx",value:"telnyx"},{text:"Twilio",value:"twilio"}],selected:"telnyx",showDelete:!1}},validations:{user:{api_key:{required:w.required},number:{required:w.required},twilio_sid:{required:w.required},twilio_token:{required:w.required},twilio_number:{required:w.required},profile:{required:w.required}}},mounted:function(){var t=this;"http://localhost:8080"===window.location.origin&&(this.baseurl="http://localhost:3000"),this.userdata=JSON.parse(this.$cookie.get("userdata")),this.access_token=this.$cookie.get("access_token"),this.headers={headers:{token:this.access_token}},this.onaddContact();var e=this;J.a.init({mainElement:".contact-list",triggerElement:".contact-list",onRefresh:function(){e.getNumberList()},distThreshold:120,distMax:140}),E.$on("changeProfile",function(){t.getOneProfile()}),E.$on("contactAdded",function(e){t.getNumberList(),setTimeout(function(){if("delete"===e||t.activeItem._id===e){var i=document.getElementsByClassName("activeChat");i.length>0&&i[0].click()}},1500)})},methods:{searchContact:function(){var t=new RegExp(this.query,"i");this.search_numbers=this.numbers.filter(function(e){return t.test(e._id)?t.test(e._id):e.contact&&t.test(e.contact.first_name)?t.test(e.contact.first_name):e.contact&&t.test(e.contact.last_name)?t.test(e.contact.last_name):t.test(e.message)?t.test(e.message):void 0})},onaddContact:function(){var t=this;this.$emit("my_signal"),this.$store.dispatch(ie,{url:"contact/get-all"}).then(function(e){t.contacts=e.data,t.$emit("onaddContact",e.data)}).catch(function(t){console.log(t)})},getValidString:function(t){if(t.length>10)var e=t.substring(0,t.length-(t.length-10))+"..";else e=t;return e},getOneProfile:function(){var t=this,e={data:{setting:this.activeProfile._id},url:"profile/getdata-one"};this.$store.dispatch(ee,e).then(function(e){t.activeProfile=e.data}).catch(function(t){console.log(t)})},refreshProfile:function(){this.$refs.childComponent.getallProfile()},onClickChild2:function(t){this.activeProfile=t},onClickChild:function(t){this.activeProfile=t,this.messageListLoader=!0,this.getNumberList(),t.refresh=!0,this.$emit("activeChat",t),this.getSetting()},firstChatShow:function(t){var e=document.getElementById(t.id);e&&(e.style.display="none"),this.activeChat=t._id,this.activeItem=t,localStorage.setItem("activenumber",f()(t)),this.$emit("clicked",t)},logout:function(){this.$cookie.delete("access_token"),this.$cookie.delete("userdata"),window.location.href="/"},getNumberList:function(){var t=this;this.numbers=[];var e={data:{user:this.userdata._id,setting:this.activeProfile._id},url:"setting/sms-number-list"};this.$store.dispatch(ee,e).then(function(e){t.numbers=e,t.messageListLoader=!1,t.searchContact()}).catch(function(t){console.log(t)})},hideShowDeleteIcon:function(t){"telnyx"===t.type&&t.api_key?this.showDelete=!0:"twilio"===t.type&&t.twilio_sid?this.showDelete=!0:this.showDelete=!1},getSetting:function(){var t=this,e={data:{user:this.userdata._id,setting:this.activeProfile._id},url:"setting/get-setting"};this.$store.dispatch(ee,e).then(function(e){e.data&&(t.user=e.data,t.hideShowDeleteIcon(e.data),t.user.twilio_number=e.data.number,e.data.number,t.getNumbers(e.data.type),t.selected=e.data.type)}).catch(function(t){console.log(t)})},deleteProfile:function(){var t=this;this.$swal.fire({icon:"info",title:"Do you want to delete this Profile?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Delete",denyButtonText:"No"}).then(function(e){if(e.isConfirmed){var i={data:{user:t.userdata._id,profile_id:t.activeProfile._id},url:"profile/delete-profile"};t.$store.dispatch(ee,i).then(function(e){if(e.data){t.$swal({icon:"success",title:"Success",text:"Profile deleted successfully!"}),t.user.api_key="",t.user.number="",t.user.twilio_sid="",t.user.twilio_token="",t.user.twilio_number="",t.tNumbers=[],t.twilioNumbers=[],t.activeProfile=e.data,localStorage.removeItem("activeProfile"),t.$refs["my-modal"].hide(),t.$refs.childComponent.getallProfile();var i=t;setTimeout(function(){i.$refs.childComponent.activeFirstProfile()},2e3)}}).catch(function(t){console.log(t)})}else e.isDenied&&t.$swal.fire("Profile not deleted","","info")})},deleteApiKey:function(){var t=this;this.$swal.fire({icon:"info",title:"Do you want to delete this setting?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Delete",denyButtonText:"No"}).then(function(e){if(e.isConfirmed){var i={data:{user:t.userdata._id,profile_id:t.activeProfile._id},url:"setting/delete-key"};t.$store.dispatch(ee,i).then(function(e){t.$swal({icon:"success",title:"Success",text:"Key deleted successfully!"}),t.user.api_key="",t.user.number="",t.user.twilio_sid="",t.user.twilio_token="",t.user.twilio_number="",t.tNumbers=[],t.twilioNumbers=[],t.activeProfile=e.data,t.hideShowDeleteIcon(e.data),t.$refs.childComponent.getallProfile()}).catch(function(t){console.log(t)})}else e.isDenied&&t.$swal.fire("setting not deleted","","info")})},getNumbers:function(t){var e=this,i=this.user;i.type=t;var s={data:i,url:"setting/get-number"};"telnyx"===t?this.tNumbers=[]:this.twilioNumbers=[],this.$store.dispatch(ee,s).then(function(i){"telnyx"===t?e.tNumbers=i.data.data:e.twilioNumbers=i.data}).catch(function(t){console.log(t)})},handleSubmit:function(t){var e=this;if(this.submitted=!0,this.$v.$touch(),""!=this.user.profile||"telnyx"===this.selected&&!this.$v.user.api_key.$error&&!this.$v.user.number.$error&&!this.$v.user.profile.$error||""!=this.user.profile||"twilio"===this.selected&&!this.$v.user.twilio_sid.$error&&!this.$v.user.twilio_token.$error&&!this.$v.user.twilio_number.$error&&!this.$v.user.profile.$error){var i="";if("telnyx"===this.selected)for(var s=0;s<this.tNumbers.length;s++)this.tNumbers[s].phone_number===this.user.number&&(i=this.tNumbers[s].id);else for(var n=0;n<this.twilioNumbers.length;n++)this.twilioNumbers[n].phoneNumber===this.user.twilio_number&&(i=this.twilioNumbers[n].sid);var a={api_key:this.user.api_key,number:this.user.number,user:this.userdata._id,sid:i,type:this.selected,twilio_sid:this.user.twilio_sid,twilio_token:this.user.twilio_token,twilio_number:this.user.twilio_number,setting:this.activeProfile._id,profile:this.user.profile};this.isLoading=!0;var o={data:a,url:"setting/create"};this.$store.dispatch(ee,o).then(function(t){e.$refs["my-modal"].hide(),e.activeProfile=t.data,e.hideShowDeleteIcon(t.data),e.$refs.childComponent.getallProfile(),E.$emit("clicked",!0),E.$emit("changeProfile2",!0),e.isLoading=!1,e.$v.$reset()}).catch(function(t){e.isLoading=!1,console.log(t)})}}}},Ot={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isLoading?i("div",{attrs:{id:"loader1"}},[t._m(0)]):t._e(),t._v(" "),i("div",{staticClass:"profile"},[i("div",{staticClass:"d-flex flex-row bd-highlight align-items-center align-self-center"},[i("div",{staticClass:"mt-2"},[i("div",{staticClass:"d-flex flex-row bd-highlight"},[i("setting"),t._v(" "),i("div",{staticClass:"bd-highlight"},[i("contact",{attrs:{contacts:t.contacts},on:{onaddContact:t.onaddContact}})],1),t._v(" "),i("div",{staticClass:"bd-highlight"},[i("b-icon",{staticClass:"m-2",staticStyle:{cursor:"pointer"},attrs:{"font-scale":"1",icon:"telephone","aria-hidden":"true",title:"Call"},on:{click:function(e){return t.$bvModal.show("modal-tall")}}})],1),t._v(" "),i("div",{staticClass:"bd-highlight"},[i("b-icon",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-2",modifiers:{"modal-2":!0}}],staticClass:"m-2",staticStyle:{cursor:"pointer"},attrs:{"font-scale":"1",icon:"pencil-square","aria-hidden":"true",title:"Compose"}})],1)],1)]),t._v(" "),i("div",{staticClass:"icons mt-2"},[i("b-dropdown",{staticClass:"dropDown",attrs:{variant:"primary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("div",{staticClass:"d-flex flex-row align-items-center bd-highlight"},[t.activeProfile?i("div",{staticClass:"d-flex flex-column bd-highlight"},[i("div",{staticClass:"profileName"},[t._v(t._s(t.activeProfile.profile))]),t._v(" "),i("div",{staticClass:"profileNum"},[t._v(t._s(t.activeProfile.number))]),t._v(" "),t.activeProfile.totalCount>0?i("span",{staticClass:"position-absolute top-0 start-100 translate-middle badge border border-light rounded-circle bg-danger p-2"},[i("span",{staticClass:"visually-hidden"},[t._v("unread messages")])]):t._e()]):i("div",[t.userdata?i("span",[t._v(t._s(t.userdata.name))]):t._e()]),t._v(" "),i("div",[i("b-icon",{staticClass:"mx-2 my-auto",attrs:{"font-scale":"1",icon:"person-badge","aria-hidden":"true",title:"Profiles"}})],1),t._v(" "),i("div",{staticClass:"droupdownAdd"})])]},proxy:!0}])},[t._v(" "),i("b-dropdown-divider"),t._v(" "),i("profile-view",{ref:"childComponent",on:{clicked2:t.onClickChild2,clicked:t.onClickChild}}),t._v(" "),i("b-dropdown-item-button",{on:{click:function(e){return t.logout()}}},[i("b-icon",{attrs:{icon:"power","aria-hidden":"true"}}),t._v("\n            Logout\n          ")],1)],1)],1)])]),t._v(" "),i("div",{staticClass:"wrap-search"},[i("div",{staticClass:"search"},[i("i",{staticClass:"fa fa-search fa",attrs:{"aria-hidden":"true"}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"input-search",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.query},on:{keyup:function(e){return t.searchContact()},input:function(e){e.target.composing||(t.query=e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"contact-list"},[t.messageListLoader?i("div",{staticClass:"box-placeholder"},[t._m(1),t._v(" "),i("hr"),t._v(" "),t._m(2),t._v(" "),i("hr"),t._v(" "),t._m(3),t._v(" "),i("hr"),t._v(" "),t._m(4)]):t._e(),t._v(" "),t._l(t.search_numbers,function(e){return i("div",{key:e._id,staticClass:"contact",class:{activeChat:t.activeChat==e._id},attrs:{id:"phone"+e._id},on:{click:function(i){return t.firstChatShow(e)}}},[i("b-icon",{staticClass:"mx-2 my-auto",attrs:{"font-scale":"2",icon:"person-bounding-box","aria-hidden":"true"}}),t._v(" "),i("div",{staticClass:"contact-preview"},[i("div",{staticClass:"contact-text"},[e.contact?i("h1",{staticClass:"font-name"},[t._v(t._s(e.contact.first_name)+" "+t._s(e.contact.last_name))]):i("h1",{staticClass:"font-name"},[t._v(t._s(e._id))]),t._v(" "),e.message?i("p",{staticClass:"font-preview"},[t._v(t._s(t.getValidString(e.message)))]):i("p",{staticClass:"font-preview"},["call"==e.message_type?i("span",["send"==e.type?i("span",[t._v(" Outbound ")]):i("span",[t._v(" Inbound ")]),t._v("\n              Call\n            ")]):t._e()])])]),t._v(" "),i("div",{staticClass:"contact-time"},[i("p",{},[t._v(t._s(t._f("moment")(e.created_at,"HH:mm")))]),t._v(" "),e.isview>0?i("span",{staticClass:"badge message_count bg-success",attrs:{id:e._id}},[t._v(t._s(e.isview))]):t._e()])],1)})],2),t._v(" "),i("b-modal",{ref:"my-modal",attrs:{id:"modal-1",size:"lg",title:"Settings","hide-footer":""}},[i("theme-button",{attrs:{"id-hide":"false"}}),t._v(" "),i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("b-form-radio-group",{attrs:{id:"btn-radios-2",options:t.options,"button-variant":"outline-primary",size:"lg",name:"radio-btn-outline",buttons:""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),t._v(" "),i("div",{staticClass:"card form-group mt-4"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"row m-auto"},[i("div",{staticClass:"col-auto m-auto mb-1 mb-sm-auto"},[i("label",[i("b-icon",{attrs:{icon:"person-fill","aria-hidden":"true"}}),t._v("\n                Profile\n              ")],1)]),t._v(" "),i("div",{staticClass:"col-sm m-auto col-10"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.profile,expression:"user.profile"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.profile.$error},attrs:{type:"text",placeholder:"Alias/Name"},domProps:{value:t.user.profile},on:{input:function(e){e.target.composing||t.$set(t.user,"profile",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.profile.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.user.profile.required?t._e():i("span",[t._v("Profile is required")])]):t._e()]),t._v(" "),i("div",{staticClass:"col-1 m-auto"},[i("span",{staticClass:"float-right",staticStyle:{cursor:"pointer"},attrs:{title:"Delete"}},[i("b-icon",{attrs:{"font-scale":"1.5",icon:"trash","aria-hidden":"true"},on:{click:function(e){return t.deleteProfile()}}})],1)])])])]),t._v(" "),"telnyx"==t.selected?i("div",{staticClass:"card form-group mt-4"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"row mb-2"},[i("div",{staticClass:"col-auto m-auto"},[i("label",[i("b-icon",{attrs:{icon:"key","aria-hidden":"true"}}),t._v(" "),i("b",[t._v("Telnyx")]),t._v(" API Key\n              ")],1)]),t._v(" "),i("div",{staticClass:"col-sm col-12 m-auto"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.api_key,expression:"user.api_key"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.api_key.$error&&""==t.user.profile},attrs:{type:"text",placeholder:"Telnyx API Key"},domProps:{value:t.user.api_key},on:{input:function(e){e.target.composing||t.$set(t.user,"api_key",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.api_key.$error&&""==t.user.profile?i("div",{staticClass:"invalid-feedback"},[t.$v.user.api_key.required?t._e():i("span",[t._v("API Key is required")])]):t._e()])]),t._v(" "),i("div",{staticClass:"row mb-2"},[i("div",{staticClass:"col-auto m-auto"},[i("button",{staticClass:"dark-mode btn btn-secondary btn-sm",attrs:{type:"button",id:"get-number"},on:{click:function(e){return t.getNumbers("telnyx")}}},[i("b-icon",{attrs:{icon:"telephone-plus","aria-hidden":"true"}}),t._v("\n                Get Number\n              ")],1)]),t._v(" "),i("div",{staticClass:"col col-lg-6 m-auto"},[i("div",{staticClass:"form-group"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.user.number,expression:"user.number"}],class:{"is-invalid":t.submitted&&t.$v.user.number.$error&&""==t.user.profile},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.user,"number",e.target.multiple?i:i[0])}}},t._l(t.tNumbers,function(e){return i("option",{key:e.id,domProps:{value:e.phone_number}},[t._v("\n                    "+t._s(e.phone_number)+"\n                  ")])}),0),t._v(" "),t.submitted&&t.$v.user.number.$error&&""==t.user.profile?i("div",{staticClass:"invalid-feedback"},[t.$v.user.number.required?t._e():i("span",[t._v("Number is required")])]):t._e()])]),t._v(" "),i("div",{staticClass:"col-auto m-auto"},[t.showDelete?i("span",{staticClass:"float-right",staticStyle:{cursor:"pointer"},attrs:{title:"Delete"},on:{click:function(e){return t.deleteApiKey()}}},[i("b-icon",{attrs:{"font-scale":"1.5",icon:"trash","aria-hidden":"true"}})],1):t._e()])])])]):t._e(),t._v(" "),"twilio"==t.selected?i("div",{staticClass:"card form-group mt-4"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"row mb-2"},[i("div",{staticClass:"col-auto col-lg-3 m-auto"},[i("label",[i("b-icon",{attrs:{icon:"key","aria-hidden":"true"}}),t._v(" "),i("b",[t._v("Twilio")]),t._v(" SID\n              ")],1)]),t._v(" "),i("div",{staticClass:"col-12 col-sm col-lg-9 m-auto"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.twilio_sid,expression:"user.twilio_sid"}],staticClass:"form-control",class:{"is-invalid":t.submitted&&t.$v.user.twilio_sid.$error&&""==t.user.profile},attrs:{type:"text",placeholder:"Twilio SID"},domProps:{value:t.user.twilio_sid},on:{input:function(e){e.target.composing||t.$set(t.user,"twilio_sid",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.twilio_sid.$error&&""==t.user.profile?i("div",{staticClass:"invalid-feedback"},[t.$v.user.twilio_sid.required?t._e():i("span",[t._v("Twilio sid is required")])]):t._e()])]),t._v(" "),i("div",{staticClass:"row mb-2"},[i("div",{staticClass:"col-auto col-lg-3 m-auto"},[i("label",[i("b-icon",{attrs:{icon:"key","aria-hidden":"true"}}),t._v(" "),i("b",[t._v("Twilio")]),t._v(" Token\n              ")],1)]),t._v(" "),i("div",{staticClass:"col-12 col-sm col-lg-9 m-auto"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.user.twilio_token,expression:"user.twilio_token"}],staticClass:"form-control ",class:{"is-invalid":t.submitted&&t.$v.user.twilio_token.$error&&""==t.user.profile},attrs:{type:"text",placeholder:"Twilio Token"},domProps:{value:t.user.twilio_token},on:{input:function(e){e.target.composing||t.$set(t.user,"twilio_token",e.target.value)}}}),t._v(" "),t.submitted&&t.$v.user.twilio_token.$error&&""==t.user.profile?i("div",{staticClass:"invalid-feedback"},[t.$v.user.twilio_token.required?t._e():i("span",[t._v("Twilio token is required")])]):t._e()])]),t._v(" "),i("div",{staticClass:"row mb-2"},[i("div",{staticClass:"col-auto m-auto"},[i("button",{staticClass:"dark-mode btn btn-secondary btn-sm",attrs:{type:"button",id:"get-number-twilio"},on:{click:function(e){return t.getNumbers("twilio")}}},[i("b-icon",{attrs:{icon:"telephone-plus","aria-hidden":"true"}}),t._v("\n                Get Number\n              ")],1)]),t._v(" "),i("div",{staticClass:"col col-lg-6 m-auto"},[i("div",{staticClass:"form-group"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.user.twilio_number,expression:"user.twilio_number"}],class:{"is-invalid":t.submitted&&t.$v.user.twilio_number.$error&&""==t.user.profile},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.user,"twilio_number",e.target.multiple?i:i[0])}}},t._l(t.twilioNumbers,function(e){return i("option",{key:e.sid,domProps:{value:e.phoneNumber}},[t._v(t._s(e.phoneNumber))])}),0),t._v(" "),t.submitted&&t.$v.user.twilio_number.$error&&""==t.user.profile?i("div",{staticClass:"invalid-feedback"},[t.$v.user.twilio_number.required?t._e():i("span",[t._v("Number is required")])]):t._e()])]),t._v(" "),i("div",{staticClass:"col-auto m-auto"},[t.showDelete?i("span",{staticClass:"float-right",staticStyle:{cursor:"pointer"},attrs:{title:"Delete"},on:{click:function(e){return t.deleteApiKey()}}},[i("b-icon",{attrs:{"font-scale":"1.5",icon:"trash","aria-hidden":"true"}})],1):t._e()])])])]):t._e(),t._v(" "),i("div",{staticClass:"d-grid d-md-flex"},[i("button",{staticClass:"btn btn-success mt-4",attrs:{type:"submit",id:"login-button"}},[t._v("Save")])])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex loader justify-content-center align-items-center"},[e("div",{staticClass:"sp sp-circle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"p-4"},[e("span",{staticClass:"category text link"}),this._v(" "),e("h4",{staticClass:"text line"}),this._v(" "),e("h4",{staticClass:"text"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"image"},[e("div",{staticClass:"embed-responsive embed-responsive-16by9"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"excerpt p-4"},[e("div",{staticClass:"text line"}),this._v(" "),e("div",{staticClass:"text line"}),this._v(" "),e("div",{staticClass:"text"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"excerpt p-4"},[e("div",{staticClass:"text line"}),this._v(" "),e("div",{staticClass:"text line"}),this._v(" "),e("div",{staticClass:"text"})])}]};var Rt=i("VU/8")(Dt,Ot,!1,function(t){i("RWJO")},"data-v-77f9c351",null).exports,Mt=i("vdhV"),qt=i.n(Mt),Ut=i("0Owv"),Ft=(i("R870"),i("vBgO").Device),Bt={props:["contacts"],data:function(){return{twilio_number:null,number:null,call_text:"test",connection:null,name:"",mm:"00",ss:"00",incoming:!1,callType:"",newCall:null,searchContacts:[],device:null}},mounted:function(){var t=this;return q()(R.a.mark(function e(){var i;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.$on("clicked",function(){}),e.next=3,t.getToken();case 3:i=e.sent,t.call_text="get token",t.deviceSetup(i);case 6:case"end":return e.stop()}},e,t)}))()},methods:{deviceSetup:function(t){var e=this,i=this;t&&("twilio"===t.type?(this.callType="twilio",Ft.setup(t.token),Ft.incoming(function(t){i.$refs["modal-tall"].show(),i.connection=t,i.number=t.options.callParameters.From,i.incoming=!0}),Ft.connect(function(t){i.connection=t,i.startTimer(),i.getContact()}),Ft.ready(function(){console.log("Connected"),this.call_text="Connected"}),Ft.disconnect(function(t){console.log("Awaiting incoming call..."),this.call_text="Awaiting incoming call...",i.dissconnected()}),Ft.cancel(function(t){i.dissconnected()}),Ft.error(function(t){console.log("error"),console.log(t)})):"telnyx"===t.type&&t.setting.sip_username&&t.setting.sip_password&&(this.callType="telnyx",this.client=new Ut.a({login:t.setting.sip_username,password:t.setting.sip_password}),this.client.connect(),this.client.remoteElement="remoteMedia",this.client.on("telnyx.ready",function(){return console.log("ready to call")}).on("telnyx.error",function(){return console.log("error")}).on("telnyx.notification",function(t){var s=t.call;if("callUpdate"===t.type)switch(i.connection=s,s.state){case"ringing":i.$refs["modal-tall"].show(),i.number=s.options.remoteCallerNumber,i.incoming=!0;break;case"active":i.connection=s,i.startTimer(),i.getContact();break;case"hangup":e.name="",e.connection=null,e.stopTimer();break;case"destroy":e.name="",e.connection=null}})))},clickHandler:function(){this.getSetting()},getToken:function(){var t=this;return new r.a(function(e){var i=JSON.parse(localStorage.getItem("activeProfile"));if(i){var s={data:{setting_id:i._id},url:"call/token"};t.$store.dispatch(ee,s).then(function(t){e(t.data)}).catch(function(t){console.log(t),e(!1)})}})},getContact:function(){var t=this,e={url:"contact/get-one",data:{number:this.number}};this.$store.dispatch(ee,e).then(function(e){e.data&&(t.name=e.data.first_name+" "+e.data.last_name)}).catch(function(t){console.log(t)})},getSetting:function(){var t,e=this,i=JSON.parse(localStorage.getItem("activeProfile"));if(i){var s={url:"setting/get-setting",data:{setting:i._id}};this.$store.dispatch(ee,s).then((t=q()(R.a.mark(function t(i){var s;return R.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.data){t.next=8;break}return localStorage.setItem("activeProfile",f()(i.data)),e.distroyDevice(),e.distroyDeviceTelnyx(),t.next=6,e.getToken();case 6:s=t.sent,e.deviceSetup(s);case 8:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)})).catch(function(t){console.log(t)})}},makeCall:function(t){this.muted=!1,this.onPhone=!0,this.number=t;var e=t.replace(/\D/g,""),i=JSON.parse(localStorage.getItem("activeProfile"));"twilio"===this.callType?this.connection=Ft.connect({number:e,twilio_number:i.number}):this.newCall=this.client.newCall({destinationNumber:e,callerNumber:i.number}),this.call_text="Calling "+e,this.$refs["modal-tall"].show()},acceptCall:function(){"twilio"===this.callType?this.connection.accept():this.connection.answer(),this.incoming=!1},rejectedCall:function(){"twilio"===this.callType?(this.connection&&this.connection.reject(),Ft.disconnectAll()):this.dissconnected(),this.connection=null,this.incoming=!1},toggleCall:function(){this.muted=!1,this.onPhone=!0;var t=this.number.replace(/\D/g,""),e=JSON.parse(localStorage.getItem("activeProfile"));"twilio"===this.callType?this.connection=Ft.connect({number:t,twilio_number:e.number}):this.newCall=this.client.newCall({destinationNumber:t,callerNumber:e.number}),this.call_text="Calling "+t},startTimer:function(){var t=0,e=this;this.userDuration=setInterval(function(){var i=parseInt(t/3600),s=parseInt(t/60),n=t%60;i=i<10?"0"+i:i,e.mm=s<10?"0"+s:s,e.ss=n<10?"0"+n:n,t++},1e3)},stopTimer:function(){this.mm="00",this.ss="00",clearInterval(this.userDuration)},dissconnected:function(){this.stopTimer(),"twilio"===this.callType?Ft.disconnectAll():this.connection.hangup(),this.name="",this.connection=null},callHangup:function(){this.dissconnected()},clickDailer:function(t){if(this.number){var e=this.number;this.number=e.toString()+t.toString()}else this.number=t},removeNumber:function(){this.number=this.number.slice(0,-1)},contactChangeEvent:function(t){this.number=t.code.replace("+","")},distroyDevice:function(){try{Ft.destroy()}catch(t){console.log(t)}},distroyDeviceTelnyx:function(){try{this.client.disconnect()}catch(t){}},formatecontact:function(t){for(var e=[],i=0;i<t.length;i++){var s={label:t[i].first_name+" "+t[i].last_name,code:t[i].number};e.push(s)}this.searchContacts=e}},watch:{contacts:function(t,e){this.formatecontact(t)}},beforeDestroy:function(){var t=JSON.parse(localStorage.getItem("activeProfile"));t&&("telnyx"===t.type&&this.distroyDeviceTelnyx(),"twilio"===t.type&&this.distroyDevice())}},Vt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-tall",modifiers:{"modal-tall":!0}}],staticStyle:{display:"none"},attrs:{id:"incomingCallModel"}},[t._v("Launch demo modal")]),t._v(" "),i("b-modal",{ref:"modal-tall",staticClass:"test-modal",attrs:{id:"modal-tall","hide-footer":""},scopedSlots:t._u([{key:"modal-header",fn:function(e){var s=e.close;return[i("b-button",{class:{"d-none":t.connection},attrs:{size:"sm",variant:"outline-danger"},on:{click:function(t){return s()}}},[t._v("\n          Close\n        ")])]}},{key:"default",fn:function(e){var s=e.hide;return[i("div",{staticClass:"d-flex justify-content-center"},[t.incoming?i("div",{staticStyle:{"max-width":"300px"}},[i("center",{staticClass:"mt-3 pt-3"},[i("div",{staticClass:"pt-4 pb-2"},[i("button",{staticClass:"btn btn-success m-1",attrs:{type:"button"}},[i("b-icon",{attrs:{icon:"person-fill","aria-hidden":"true"}})],1),t._v(" "),i("p",{staticClass:"font-weight-bold mt-2",staticStyle:{"font-size":"30px",color:"#787878","margin-bottom":"0"}},[t._v("\n                        "+t._s(t.name)+"\n                    ")]),t._v(" "),i("p",{staticClass:"font-weight-bold",staticStyle:{"font-size":"30px",color:"#787878"}},[t._v("\n                        "+t._s(t.number)+"\n                    ")])]),t._v(" "),i("h4",{staticClass:"mb-4"},[t._v("Incoming call")]),t._v(" "),i("button",{staticClass:"btn btn-success m-1",attrs:{type:"button"},on:{click:function(e){return t.acceptCall()}}},[i("b-icon",{attrs:{icon:"telephone-fill","aria-hidden":"true"}})],1),t._v(" "),i("button",{staticClass:"btn btn-danger m-1",attrs:{type:"button"},on:{click:function(e){return t.rejectedCall()}}},[i("b-icon",{attrs:{icon:"x-circle","aria-hidden":"true"}})],1)])],1):i("div",{staticStyle:{"max-width":"300px"}},[i("v-select",{staticClass:"mb-2",attrs:{options:t.searchContacts},on:{"option:selected":function(e){return t.contactChangeEvent(e)}}}),t._v(" "),i("b-form-group",{staticStyle:{"margin-bottom":"0"},attrs:{id:"input-group-1"}},[i("b-form-input",{staticClass:"chat-input",attrs:{id:"dailer_number",type:"number",required:""},model:{value:t.number,callback:function(e){t.number=e},expression:"number"}})],1),t._v(" "),t.connection?t._e():i("div",[i("div",{staticClass:"d-flex justify-content-between mt-4"},[i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(1)}}},[i("p",{staticClass:"number font-weight-bolder mb-0"},[t._v("1")]),t._v(" "),i("p",{staticClass:"alpha hide"})])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(2)}}},[i("p",{staticClass:"number font-weight-bolder mb-0"},[t._v("2")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("abc")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(3)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("3")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("def")])])])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-between"},[i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(4)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("4")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("ghi")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(5)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("5")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("jkl")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(6)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("6")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("mno")])])])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-between"},[i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(7)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("7")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("pqrs")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(8)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("8")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("tuv")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(9)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("9")]),t._v(" "),i("p",{staticClass:"alpha"},[t._v("wxyz")])])])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-between"},[i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2"},[i("p",{staticClass:"number font-weight-bolder"},[t._v("*")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2",on:{click:function(e){return t.clickDailer(0)}}},[i("p",{staticClass:"number font-weight-bolder"},[t._v("0")])])]),t._v(" "),i("div",[i("a",{staticClass:"btn btn-light-primary dialer-btn2 "},[i("p",{staticClass:"number font-weight-bolder"},[t._v("#")])])])])]),t._v(" "),t.connection?i("div",[i("div",{staticClass:"dropdown float-right dropleft row m-0",staticStyle:{width:"100%"},attrs:{id:"call_number"}},[i("div",{staticClass:"dialer_bg multiCallData",staticStyle:{width:"100%"},attrs:{id:"data.call.sid"}},[i("div",{staticClass:"row dialer_bg p-2"},[i("div",{staticClass:"d-flex flex-row bd-highlight mb-3 justify-content-center",staticStyle:{width:"100%"}},[i("a",{staticClass:"btn btn-icon btn-success mr-3 dialer-btn mt-4"},[i("button",{staticClass:"btn btn-success m-1",attrs:{type:"button"}},[i("b-icon",{attrs:{icon:"person-fill","aria-hidden":"true"}})],1)])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[i("span",{staticClass:"multiCallData_name"},[t._v(t._s(t.name))])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[i("span",{staticClass:"multiCallData_name"},[t._v(" "+t._s(t.number))])]),t._v(" "),i("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[i("span",{staticClass:"timerContainer font-weight-bold mx-auto float-right mt-2",staticStyle:{"font-size":"45px",color:"#4d64bc"}},[i("span",{staticClass:"multiCallData_minute",attrs:{id:"data.call.sid"}},[t._v(t._s(t.mm))]),t._v(":"),i("span",{staticClass:"multiCallData_second",attrs:{id:" data.call.sid"}},[t._v(t._s(t.ss))])])])]),t._v(" "),i("div",{staticClass:"p-1 mt-5 pt-5"},[i("button",{staticClass:"btn btn-danger multiCallData_hangup w-100",staticStyle:{width:"100%","font-size":"30px"},attrs:{"data-id":' number + "',"data-sid":'data.call.sid+"',"data-type":'callType+"'},on:{click:function(e){return t.callHangup()}}},[t._v("Hangup")])])])])]):i("div",{staticClass:"dialer-container single_header"},[i("ul",{staticClass:"dialer-pad"},[i("center",{staticClass:"mt-4"},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-success m-1 px-5",attrs:{type:"button",title:"Call"},on:{click:function(e){return t.toggleCall()}}},[i("b-icon",{attrs:{icon:"telephone-outbound","aria-hidden":"true"}})],1),t._v(" "),i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-danger m-1 px-5",attrs:{type:"button",title:"Delete"},on:{click:function(e){return t.removeNumber()}}},[i("b-icon",{attrs:{icon:"backspace","aria-hidden":"true"}})],1)])],1)])],1)]),t._v(" "),i("b-button",{staticStyle:{display:"none"},on:{click:function(t){return s()}}},[t._v("Hide Modal")])]}}])}),t._v(" "),i("audio",{attrs:{id:"remoteMedia",autoplay:"true"}})],1)},staticRenderFns:[]};var jt=i("VU/8")(Bt,Vt,!1,function(t){i("rqwt")},"data-v-b3310094",null).exports,zt=i("x6bz"),Ht={name:"dashboard",components:{NumberList:Rt,VueTagsInput:qt.a,ThemeButton:b,Setting:Lt,CallView:jt},data:function(){return{isLoading:!1,fullPage:!0,contacts:[],selectedContact:"",dropArea:null,progressBar:null,filesDone:0,filesToDo:0,uploadProgress:[],uploadedImages:[],activeChatData:!1,activeProfile:null,activeChat:"",msg:"Welcome to dashboard",tags:[],sms:{numbers:"",message:""},setting:{},chatListLoader:!1,submitted2:!1,userdata:null,access_token:null,headers:null,messages:[],messageBody:"",socket:null,baseurl:"",vw:0,vh:0,modelMms:!1,modelFileValu:"",zoomImage:"",searchContacts:[],activeCallTab:!1}},created:function(){window.addEventListener("resize",this.updateVw,{passive:!0})},destroyed:function(){window.removeEventListener("resize",this.updateVw,{passive:!0})},mounted:function(){var t=this;E.$on("toggleLoader",function(){t.toggleLoader()}),E.$on("contactAdded",function(e){t.activeChat._id===e&&t.showChat(t.activeChat)}),E.$on("changeProfile2",function(){t.activeChat=null,t.activeCallTab=!1,setTimeout(function(){t.activeCallTab=!0},1500)}),E.$on("changeProfile",function(){t.activeChat=null,t.activeCallTab=!1,setTimeout(function(){t.activeCallTab=!0},1500)}),this.$cookie.get("access_token")||this.$router.push("/"),this.updateVw(),"http://localhost:8080"===window.location.origin&&(this.baseurl="http://localhost:3000");var e=zt(this.baseurl,{transports:["websocket"]});this.socket=e;var i=this;this.socket.on("new_message",function(t){i.getNumberList(),i.activeChatData&&i.showChat(i.activeChat)}),this.userdata=JSON.parse(this.$cookie.get("userdata")),this.access_token=this.$cookie.get("access_token"),this.socket.emit("join_profile_channel",this.userdata._id.toString()),this.socket.on("user_message",function(t){i.activeChatData?i.showChat(i.activeChat):(i.$refs.numberList.getOneProfile(),i.$refs.numberList.refreshProfile()),i.$refs.numberList.getNumberList(),i.notifyMe(t.number,t.message)}),this.headers={headers:{token:this.access_token}},this.dropArea=document.getElementById("drop-area1"),["dragenter","dragover","dragleave","drop"].forEach(function(e){t.dropArea.addEventListener(e,t.preventDefaults,!1)}),["dragenter","dragover"].forEach(function(e){t.dropArea.addEventListener(e,t.highlight,!1)}),["dragleave","drop"].forEach(function(e){t.dropArea.addEventListener(e,t.unhighlight,!1)}),this.dropArea.addEventListener("drop",this.handleDrop,!1),this.progressBar=document.getElementById("progress-bar")},validations:{sms:{numbers:{required:w.required},message:{required:w.required}}},methods:{addContact:function(t){E.$emit("addContact",t)},toggleLoader:function(){this.isLoading?this.isLoading=!1:this.isLoading=!0},makeCall:function(){this.activeChat&&this.$refs.callView.makeCall(this.activeChat._id)},messageRefresh:function(){this.messages=[]},contactChangeEvent:function(t){var e={text:t.code,tiClasses:["ti-valid"]};this.tags.push(e),this.selectedContact=""},onaddContact:function(t){this.contacts=t,this.formatecontact(t)},formatecontact:function(t){for(var e=[],i=0;i<t.length;i++){var s={label:t[i].first_name+" "+t[i].last_name,code:t[i].number};e.push(s)}this.searchContacts=e},hiddenImage:function(){this.zoomImage="",document.getElementById("hidden").style.display="none"},showImage:function(t){this.zoomImage=t,document.getElementById("hidden").style.display="block"},choseFile2:function(){document.getElementById("model_file_input").click()},file_upload:function(){document.getElementById("fileElem").click()},initializeProgress:function(t){this.progressBar.value=0,this.uploadProgress=[];for(var e=this.numFiles;e>0;e--)this.uploadProgress.push(0)},updateProgress:function(t,e){this.uploadProgress[t]=e;var i=this.uploadProgress.reduce(function(t,e){return t+e},0)/this.uploadProgress.length;this.progressBar.value=i},progressDone:function(){this.filesDone++,this.progressBar.value=this.filesDone/this.filesToDo*100},handleDrop:function(t){var e=t.dataTransfer.files;this.handleFiles(e)},handleFiles:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){this.modelMms=!0;for(var e=[],i=0;i<t.length;i++)e.push(t[i].name);this.modelFileValu=e.join()}else this.modelMms=!1;t=[].concat(N()(t)),this.initializeProgress(t.length),t.forEach(this.uploadFile)},previewFile:function(t){var e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){var t=document.createElement("img");t.style.width="150px",t.src=e.result,document.getElementById("gallery").appendChild(t)}},removeFromPrevie:function(t){for(var e=[],i=0;i<this.uploadedImages.length;i++)this.uploadedImages[i]!==t&&e.push(this.uploadedImages[i]);this.uploadedImages=e,this.uploadedImages.length<=0&&(document.getElementById("drop-area").style.display="none")},uploadFile:function(t,e){var i=this.baseurl+"/api/media/upload-files",s=new XMLHttpRequest,n=new FormData;s.open("POST",i,!0),s.setRequestHeader("token",this.access_token);var a=this;s.upload.addEventListener("progress",function(t){a.updateProgress(e,100*t.loaded/t.total||100)}),s.addEventListener("readystatechange",function(t){if(4===s.readyState&&200===s.status){var e=JSON.parse(s.responseText);a.uploadedImages.push(""+e.data.media)}else 4===s.readyState&&s.status}),n.append("file",t),s.send(n)},highlight:function(t){document.getElementById("drop-area").style.display="block",this.dropArea.classList.add("highlight")},unhighlight:function(t){this.dropArea.classList.remove("highlight")},preventDefaults:function(t){t.preventDefault(),t.stopPropagation()},activeProfileView:function(t){void 0!==t.refresh&&t.refresh&&(this.messages=[]),this.activeProfile=t},onClickChild:function(t){this.firstChatShow(t)},notifyMe:function(t,e){var i="https://www.operationprivacy.com/img/favicon/favicon.ico";if("Notification"in window)if("granted"===Notification.permission){new Notification("Message from "+t,{body:e,dir:"auto",icon:i})}else"denied"!==Notification.permission&&Notification.requestPermission(function(s){("permission"in Notification||(Notification.permission=s),"granted"===s)&&new Notification("Message from "+t,{body:e,dir:"auto",icon:i})});else alert("This browser does not support desktop notification")},deletechat:function(){var t=this;this.$swal.fire({icon:"info",title:"Do you want to delete this chat?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Delete",denyButtonText:"No"}).then(function(e){if(e.isConfirmed){var i={data:{user:t.userdata._id,number:t.activeChat},url:"setting/message-list-delete"};t.$store.dispatch(ee,i).then(function(e){t.activeChatData&&t.showChat(t.activeChat),t.$refs.numberList.getNumberList()}).catch(function(t){console.log(t)})}else e.isDenied&&t.$swal.fire("chat not deleted","","info")})},sendSms:function(){if(this.isLoading=!0,""===this.messageBody.trim()&&0===this.uploadedImages.length)return this.$swal({icon:"error",title:"Oops...",text:"Message or file required"}),void(this.isLoading=!1);var t=[JSON.parse(localStorage.getItem("activenumber"))._id];this.commonSendMessage(t,this.messageBody)},commonSendMessage:function(t,e){var i=this,s={data:{user:this.userdata._id,numbers:t,message:e,profile:this.activeProfile,media:this.uploadedImages},url:"setting/send-sms"};this.$store.dispatch(ee,s).then(function(t){i.messageBody="",i.sms.numbers="",i.sms.message="",i.uploadedImages=[],i.modelFileValu="",document.getElementById("drop-area").style.display="none",i.tags=[],i.$refs.numberList.getNumberList(),i.activeChatData&&i.showChat(i.activeChat),i.$refs["my-modal2"].hide(),i.vw<576&&i.$refs.mySidebar2.hide(),i.isLoading=!1}).catch(function(t){console.log(t)})},firstChatShow:function(t){this.chatListLoader=!0;var e=document.getElementById(t._id);e&&e.remove(),this.showChat(t),document.getElementById("drop-area").style.display="none",this.uploadedImages=[],this.vw<576&&this.$refs.mySidebar2.hide()},showChat:function(t){var e=this;this.activeChat=t,this.activeChatData=!0;var i={data:{user:this.userdata._id,number:t,profile:this.activeProfile},url:"setting/message-list"};this.$store.dispatch(ee,i).then(function(t){e.messages=t,setTimeout(function(){var t=document.getElementById("chat-container");t.scrollTop=t.scrollHeight,t.animate({scrollTop:t.scrollHeight}),e.chatListLoader=!1},1e3),e.$refs.numberList.refreshProfile(),e.$refs.numberList.getOneProfile()}).catch(function(t){console.log(t)})},handleSubmit2:function(t){if(this.submitted2=!0,this.$v.$touch(),this.isLoading=!0,this.tags.length<=0)this.$swal({icon:"error",title:"Oops...",text:"please enter number!"});else{for(var e=[],i=0;i<this.tags.length;i++)e.push(this.tags[i].text);!this.$v.sms.message.$error||this.uploadedImages.length>0?this.commonSendMessage(e,this.sms.message):(this.$swal({icon:"error",title:"Oops...",text:"Message or file required!"}),this.isLoading=!1)}},updateVw:function(){this.vw=this.getVw(),this.vh=this.getVh();var t=this.vh-120;document.getElementById("wrapbody").style.height=this.vh+"px",document.getElementById("chat_body").style.height=t+"px"},getVw:function(){return Math.round(Math.max(document.documentElement.clientWidth||0,window.innerWidth||0))},getVh:function(){return Math.round(Math.max(document.documentElement.innerHeight||0,window.innerHeight||0))},getMMSS:function(t){var e=~~t%60,i="";return i+=~~(t%3600/60)+":"+(e<10?"0":""),i+=""+e}}},Jt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrap",attrs:{id:"wrapbody"}},[t.activeCallTab?i("call-view",{ref:"callView",attrs:{contacts:t.contacts}}):t._e(),t._v(" "),t.isLoading?i("div",{attrs:{id:"loader"}},[t._m(0)]):t._e(),t._v(" "),i("theme-button",{attrs:{"id-hide":"true"}}),t._v(" "),t.vw<576?i("b-sidebar",{ref:"mySidebar2",staticClass:"d-sm-none",attrs:{id:"sidebar-no-header","aria-labelledby":"sidebar-no-header-title","no-header":"",shadow:"",backdrop:"",visible:""},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.hide;return[i("div",{staticClass:"d-flex flex-row-reverse bd-highlight"},[i("div",{staticClass:"bd-highlight dropDown"},[i("b-button",{staticClass:"float-right d-flex",attrs:{size:"sm",variant:"primary"}},[i("b-icon",{attrs:{icon:"x",scale:"1"},on:{click:s}})],1)],1)]),t._v(" "),i("number-list",{ref:"numberList",on:{onaddContact:t.onaddContact,activeChat:t.activeProfileView,clicked:t.onClickChild}})]}}],null,!1,2507129991)}):t._e(),t._v(" "),i("section",{staticClass:"col-auto col-md-4 d-none d-sm-block"},[t.vw>=576?i("number-list",{ref:"numberList",on:{onaddContact:t.onaddContact,activeChat:t.activeProfileView,clicked:t.onClickChild}}):t._e()],1),t._v(" "),i("section",{staticClass:"col col-md-8 pb-2",attrs:{id:"drop-area1"}},[i("div",{staticClass:"chat-head"},[i("b-icon",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-no-header",modifiers:{"sidebar-no-header":!0}}],staticClass:"mx-3 my-auto d-sm-none h2",attrs:{"font-scale":"2",icon:"chevron-left","aria-hidden":"true"}}),t._v(" "),i("b-icon",{staticClass:"mx-2 my-auto",attrs:{"font-scale":"2",icon:"person-bounding-box","aria-hidden":"true"}}),t._v(" "),i("div",{staticClass:"chat-name"},[t.activeChat?i("h1",{staticClass:"font-name"},[t.activeChat.contact?i("div",{staticClass:"d-flex align-items-start align-self-center"},[i("div",{staticClass:"mt-2 ml-4"},[t._v(t._s(t.activeChat.contact.first_name)+" "+t._s(t.activeChat.contact.last_name))])]):t._e(),t._v(" "),i("div",{staticClass:"d-flex align-items-start align-self-center"},[i("div",{staticClass:"mt-2 ml-4"},[t._v(t._s(t.activeChat._id))]),t._v("\n               \n            "),t.activeChat.contact?t._e():i("span",{staticStyle:{cursor:"copy"},attrs:{title:"Add Contact"},on:{click:function(e){return t.addContact(t.activeChat._id)}}},[i("b-icon",{attrs:{"font-scale":"1.5",icon:"plus-circle","aria-hidden":"true"}})],1)])]):t._e()]),t._v(" "),t.activeChat?i("div",{staticClass:"d-flex m-auto"},[i("span",{staticStyle:{cursor:"pointer"},attrs:{title:"Delete"},on:{click:function(e){return t.makeCall()}}},[i("b-icon",{attrs:{"font-scale":"2",icon:"telephone","aria-hidden":"true"}})],1),t._v("\n           \n        "),i("span",{staticStyle:{cursor:"pointer"},attrs:{title:"Delete"},on:{click:function(e){return t.deletechat()}}},[i("b-icon",{attrs:{"font-scale":"2",icon:"trash","aria-hidden":"true"}})],1)]):t._e()],1),t._v(" "),i("div",{class:!this.activeChat||t.modelMms?"d-none":""},[i("div",{class:t.uploadedImages.length>0?"activeImageArea":"inactive",staticStyle:{"z-index":"1"},attrs:{id:"drop-area"}},[i("form",{staticClass:"my-form"},[i("p",[t._v("Upload multiple files by dragging and dropping images inside this box")]),t._v(" "),i("input",{attrs:{type:"file",id:"fileElem",multiple:"",accept:"image/*"},on:{change:function(e){return t.handleFiles(e.target.files)}}})]),t._v(" "),i("div",{staticClass:"row",attrs:{id:"gallery"}},t._l(t.uploadedImages,function(e){return i("div",{key:e,staticClass:"col-lg-4"},[i("img",{staticStyle:{width:"150px"},attrs:{src:e}}),t._v(" "),i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(i){return t.removeFromPrevie(e)}}},[i("span",{staticClass:"start-100 translate-middle badge border border-light rounded-circle bg-danger"},[t._v("X")])])])}),0),t._v(" "),i("progress",{staticStyle:{display:"none"},attrs:{id:"progress-bar",max:"100",value:"0"}})])]),t._v(" "),i("div",{staticClass:"wrap-chat",attrs:{id:"chat_body"}},[t.chatListLoader?i("div",{staticClass:"chat row"},[t._m(1)]):t._e(),t._v(" "),i("div",{staticClass:"chat",class:{opacitynone:t.chatListLoader},attrs:{id:"chat-container"}},[t.activeChatData?i("div",t._l(t.messages,function(e){return i("div",{key:e._id},[i("div",{staticClass:"chat-bubble",class:{me:"send"==e.type,you:"receive"==e.type}},[i("div",{class:{"my-mouth":"send"==e.type,"your-mouth":"receive"==e.type}}),t._v(" "),i("div",{staticClass:"content"},[e.media&&JSON.parse(e.media)&&JSON.parse(e.media).length>0?i("span",t._l(JSON.parse(e.media),function(e){return i("span",{key:e},[i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(i){return t.showImage(e)}}},[i("img",{attrs:{src:e,alt:"Image"}})])])}),0):t._e(),t._v(" "),"call"===e.datatype?i("span",["send"===e.type?i("span",[i("b-icon",{attrs:{icon:"telephone-outbound-fill"}}),t._v("   Outbound")],1):i("span",[i("b-icon",{attrs:{icon:"telephone-inbound-fill"}}),t._v("   Inbound")],1),t._v("\n                  Call( "+t._s(t.getMMSS(e.duration))+" )\n                ")]):i("span",[t._v(" "+t._s(e.message)+" ")])]),t._v(" "),i("div",{staticClass:"time"},[t._v("\n                "+t._s(t._f("moment")(e.created_at,"HH:mm"))+"\n              ")])])])}),0):t._e()])]),t._v(" "),i("div",{staticClass:"row wrap-container"},[i("div",{staticClass:"col-md-12 wrap-container2"},[t.activeChatData?i("div",{staticClass:"wrap-message"},[i("div",{staticClass:"message pl-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.messageBody,expression:"messageBody"}],staticClass:"input-message",attrs:{type:"text",placeholder:"Type message here"},domProps:{value:t.messageBody},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendSms.apply(null,arguments)},input:function(e){e.target.composing||(t.messageBody=e.target.value)}}}),t._v(" "),i("a",{staticClass:"m-2",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.file_upload()}}},[i("b-icon",{attrs:{icon:"paperclip",scale:"2"}})],1)]),t._v(" "),i("div",{staticClass:"btn btn-primary m-2",staticStyle:{height:"36px"},on:{click:function(e){return t.sendSms()}}},[i("b-icon",{attrs:{icon:"arrow-right-circle-fill","aria-hidden":"true"}})],1)]):t._e()])])]),t._v(" "),i("b-modal",{ref:"my-modal2",attrs:{id:"modal-2",size:"lg",title:"Compose Message","hide-footer":""}},[i("span",{staticClass:"small text-secondary"},[t._v("Input (+) and country code followed by the 10 digit phone number. If no country code is provided (+1) is assumed. Multiple numbers will be sent as Bulk SMS (individual sms's to recipients). "),i("span",{staticClass:"small text-center"},[t._v("[Telnyx does not support group texting]")])]),t._v(" "),i("form",{staticClass:"ml-2 mr-2",on:{submit:function(e){return e.preventDefault(),t.handleSubmit2.apply(null,arguments)}}},[i("v-select",{staticClass:"mt-4",attrs:{options:t.searchContacts},on:{"option:selected":function(e){return t.contactChangeEvent(e)}}}),t._v(" "),i("div",{staticClass:"form-group mt-4"},[i("vue-tags-input",{staticClass:"form-control chat-input",attrs:{tags:t.tags,placeholder:"Enter phone number"},on:{"tags-changed":function(e){return t.tags=e}},model:{value:t.sms.numbers,callback:function(e){t.$set(t.sms,"numbers",e)},expression:"sms.numbers"}}),t._v(" "),t.tags.length<=0?i("div",{staticClass:"invalid-feedback"},[i("span",[t._v("Numbers are required")])]):t._e()],1),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sms.message,expression:"sms.message"}],staticClass:"form-control chat-input",class:{"is-invalid":t.submitted2&&t.$v.sms.message.$error},attrs:{rows:"8",placeholder:"Type Message here"},domProps:{value:t.sms.message},on:{input:function(e){e.target.composing||t.$set(t.sms,"message",e.target.value)}}}),t._v(" "),t.submitted2&&t.$v.sms.message.$error?i("div",{staticClass:"invalid-feedback"},[t.$v.sms.message.required?t._e():i("span",[t._v("Message is required")])]):t._e()]),t._v(" "),i("div",{staticClass:"input-group mb-3"},[i("div",{staticClass:"input-group-prepend"},[i("span",{staticClass:"input-group-text paperClip chat-input",attrs:{id:"basic-addon1"},on:{click:function(e){return t.choseFile2()}}},[i("b-icon",{attrs:{icon:"paperclip"}})],1)]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.modelFileValu,expression:"modelFileValu"}],staticClass:"form-control chat-input",attrs:{type:"text",placeholder:"Choose file","aria-label":"Username",readonly:"","aria-describedby":"basic-addon1"},domProps:{value:t.modelFileValu},on:{click:function(e){return t.choseFile2()},input:function(e){e.target.composing||(t.modelFileValu=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group mb-2 mt-4 d-none"},[i("input",{staticClass:"form-control chat-input",attrs:{type:"file",id:"model_file_input",multiple:"",accept:"image/*"},on:{change:function(e){return t.handleFiles(e.target.files,!0)}}})]),t._v(" "),i("div",{staticClass:"d-grid d-md-flex"},[i("button",{staticClass:"btn btn-primary",attrs:{type:"submit",id:"login-button"}},[t._v("Send Message")])])],1)]),t._v(" "),i("div",{attrs:{id:"hidden"},on:{click:function(e){return t.hiddenImage()}}},[i("div",{staticClass:"d-flex justify-content-center align-items-center",staticStyle:{height:"100vh",width:"100vw"}},[i("img",{staticClass:"img-fluid",attrs:{alt:"Responsive image",src:t.zoomImage}})])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex loader justify-content-center align-items-center"},[e("div",{staticClass:"sp sp-circle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loading-bar"},[e("div",{staticClass:"blue-bar"})])}]};var Gt=i("VU/8")(Ht,Jt,!1,function(t){i("tDut")},"data-v-7a1b5471",null).exports,Wt=i("Tqaz"),Kt=i("a+8X"),Zt=i.n(Kt);i("Jmt5"),i("9M+g");i("CuRo"),s.default.use(Wt.a),s.default.use(Wt.b),s.default.component("input-tag",Zt.a),s.default.use(h.a),s.default.use(p.a);var Yt,Xt=new h.a({mode:"history",routes:[{path:"/",name:"login",component:S},{path:"/signup",name:"signup",component:$},{path:"/dashboard",name:"dashboard",component:Gt}]}),Qt=i("e7x4"),te=i.n(Qt),ee="post",ie="get",se={actions:(Yt={},a()(Yt,ee,function(t,e){return new r.a(function(t){u.setHeader(),u.post(e.url,e.data).then(function(e){var i=e.data;t(i)}).catch(function(t){var e=t.response;console.log(e),401===e.status&&(te.a.fire({title:"Error",text:"Unauthorized Access!",icon:"error",confirmButtonClass:"btn btn-secondary",heightAuto:!1}),s.default.cookie.delete("access_token"),s.default.cookie.delete("userdata"),Xt.push("/")),400===e.status&&te.a.fire({title:"Error",text:e.data.message,icon:"error",confirmButtonClass:"btn btn-secondary",heightAuto:!1})})})}),a()(Yt,ie,function(t,e){return new r.a(function(t){u.setHeader(),u.get(e.url).then(function(e){var i=e.data;t(i)}).catch(function(e){var i=e.response;401===i.status&&(te.a.fire({title:"Error",text:i.data.error,icon:"error",confirmButtonClass:"btn btn-secondary",heightAuto:!1}),s.default.cookie.delete("access_token"),s.default.cookie.delete("userdata"),Xt.push("/")),400===i.status&&te.a.fire({title:"Error",text:i.data.message,icon:"error",confirmButtonClass:"btn btn-secondary",heightAuto:!1}),t(!1)})})}),Yt),mutations:{SET_ERROR:function(t,e){t.errors=e}},state:{panel:[]},getters:{}},ne={name:"App",components:{ThemeButton:b},data:function(){return{old_version:!1}},mounted:function(){this.getVersion()},methods:{getVersion:function(){var t=this;this.$store.dispatch(ie,{url:"auth/get-update-version"}).then(function(e){console.log(e.update),"true"===e.update?t.old_version=!0:t.old_version=!1}).catch(function(e){t.old_version=!1,console.log(e)})}}},ae={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[this.old_version?e("span",{staticClass:"update_ribbon"},[e("a",{attrs:{href:"https://github.com/0perationPrivacy/VoIP/blob/main/CHANGELOG.md",target:"_blank",rel:"noopener noreferrer"}},[this._v("update")])]):this._e(),this._v(" "),e("router-view")],1)},staticRenderFns:[]},oe=i("VU/8")(ne,ae,!1,null,null,null).exports,re=i("NOK/"),le=i.n(re),ce=(i("UdIB"),i("NYxO"));s.default.use(ce.a);var de=new ce.a.Store({modules:{common:se}}),ue=i("bNL2"),he=i.n(ue),me=i("lrIR"),pe=i("T1ft"),ve=i.n(pe),fe=i("K/Lq");window.axios=i("mtWM"),s.default.use(he.a),s.default.component("v-select",ve.a),s.default.use(me.a),u.init(),s.default.use(fe),s.default.config.productionTip=!1,s.default.use(le.a),s.default.use(i("8AgW")),new s.default({el:"#app",router:Xt,store:de,components:{App:oe},template:"<App/>"})},R870:function(t,e){},RWJO:function(t,e){},SNJk:function(t,e){},UdIB:function(t,e){},XBCt:function(t,e){},rqwt:function(t,e){},tDut:function(t,e){},v5Fl:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.2c415f1931778f820bd6.js.map